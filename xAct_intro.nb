(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    128495,       3301]
NotebookOptionsPosition[    114580,       3119]
NotebookOutlinePosition[    115353,       3145]
CellTagsIndexPosition[    115310,       3142]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Introduction to xAct", "Chapter",
 CellChangeTimes->{{3.87800451289979*^9, 
  3.8780045191634383`*^9}},ExpressionUUID->"460c2ee8-7b59-4e7f-8f8d-\
e2f9eb42901b"],

Cell["Jiwon Park, Novem\[AliasDelimiter]ber 29, 2022", "Subtitle",
 CellChangeTimes->{{3.8780045306632805`*^9, 3.8780045566918707`*^9}, 
   3.8811120019537554`*^9},ExpressionUUID->"ffc75fdf-1f7c-4162-b2f0-\
daa80453e42b"],

Cell[CellGroupData[{

Cell["What is xAct?", "Section",
 CellChangeTimes->{{3.8786917515695753`*^9, 3.878691784586096*^9}, {
  3.8786918407633724`*^9, 
  3.878691847118681*^9}},ExpressionUUID->"2efcd2c8-95de-449a-aff3-\
f662ae8bf524"],

Cell["\<\
xACt is a Mathematica package to conduct symbolic computation in general \
relativity. It has the broadest usage among codes currently out, allowing \
many techniques including curvature computation, coordinates transformation, \
rule-based computation, action principle and perturbation theory.\
\>", "Text",
 CellChangeTimes->{{3.8786918669780793`*^9, 3.878691926542816*^9}, {
  3.8786919847526717`*^9, 3.8786920799245276`*^9}, {3.8786921824087887`*^9, 
  3.8786921892182207`*^9}, {3.878692238658499*^9, 3.8786922710953007`*^9}, {
  3.878693027491934*^9, 
  3.878693060767893*^9}},ExpressionUUID->"bd492a49-18bf-4c21-8cf7-\
8dfe74ff4efe"],

Cell[CellGroupData[{

Cell["load package", "Subsection",
 CellChangeTimes->{{3.878693073392931*^9, 
  3.8786930760076036`*^9}},ExpressionUUID->"692e99ae-2864-4465-ab27-\
3f7972ebd803"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Quiet", "@", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "Print", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"<<", "xAct`xTensor`"}], ";", 
      RowBox[{"<<", "xAct`xCoba`"}], ";"}]}], "]"}]}], " ", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "quiet", " ", "and", " ", "block", " ", "command", " ", "are", " ", "just",
     " ", "used", " ", "to", " ", "suppress", " ", "messy", " ", "output"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"removeAll", ":=", 
    RowBox[{"Remove", "[", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"$Context", "<>", "\"\<*\>\""}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "To", " ", "clear", " ", "symbols", " ", "so", " ", "that", " ", "no", 
     " ", "error", " ", "arise", " ", "when", " ", "running", " ", 
     RowBox[{"codes", ".", "\[IndentingNewLine]", "Credit"}], " ", 
     RowBox[{"to", ":", " ", "https", ":"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", 
        "questions"}], "/", "850"}], "/", "how"}], "-", "do", "-", "i", "-", 
     "clear", "-", "all", "-", "user", "-", "defined", "-", "symbols"}]}], 
   "\[IndentingNewLine]", "*)"}]}], "\n", 
 RowBox[{"removeAll", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"removeAll", ":=", 
   RowBox[{"Remove", "[", 
    RowBox[{"Evaluate", "[", 
     RowBox[{"$Context", "<>", "\"\<*\>\""}], "]"}], "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.8784417016748004`*^9, 3.878441714776963*^9}, {
  3.8786070743424807`*^9, 3.8786070861716976`*^9}, {3.878608061907696*^9, 
  3.87860811314814*^9}, {3.8786930842804575`*^9, 3.8786931163551035`*^9}, {
  3.880664143400528*^9, 3.880664152931756*^9}, {3.880664182980994*^9, 
  3.8806642061710773`*^9}, {3.880667108994233*^9, 3.8806671878945265`*^9}, {
  3.8806672493603053`*^9, 3.8806672712087545`*^9}, {3.8806673922070217`*^9, 
  3.8806673932584105`*^9}, {3.880667438022236*^9, 3.880667458466144*^9}, {
  3.881111818444322*^9, 3.881111826820629*^9}},
 CellLabel->
  "In[414]:=",ExpressionUUID->"e350c9a5-dc0b-4645-ba7e-64819a6d8ddd"],

Cell["\<\
Don' t be alarmed if a new DOS window opens! It' s just an external \
computation module supporting xAct .\
\>", "Text",
 CellChangeTimes->{{3.8806637963808827`*^9, 
  3.880663817887125*^9}},ExpressionUUID->"87c57fea-7937-4eed-a89e-\
be241fdb3c59"]
}, Open  ]],

Cell[CellGroupData[{

Cell["declare manifold and tensors", "Subsection",
 CellChangeTimes->{{3.87869312878715*^9, 
  3.878693158513545*^9}},ExpressionUUID->"98ce497b-12c7-4fe0-8610-\
f245765d8092"],

Cell["\<\
M denotes manifold, 4 is dimension, a,b,c,d are coordinates indices.\
\>", "Text",
 CellChangeTimes->{{3.8786932892587557`*^9, 3.8786932970743637`*^9}, {
  3.880665944790574*^9, 
  3.880665948817297*^9}},ExpressionUUID->"b9bb3555-fa34-4284-b97a-\
59f93ad0a63e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DefManifold", "[", 
   RowBox[{"M", ",", "4", ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "]"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.878441736182189*^9, 3.8784417373911705`*^9}, {
  3.878693188716199*^9, 3.8786932367037883`*^9}, {3.878693280875987*^9, 
  3.878693283386865*^9}},
 CellLabel->
  "In[419]:=",ExpressionUUID->"e6f6ad84-b6bb-4a5e-9fae-22212ed29ecc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DefScalarFunction", "/@", 
   RowBox[{"{", 
    RowBox[{"X", ",", "Y"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DefScalarFunction", "/@", 
    RowBox[{"{", 
     RowBox[{"R", ",", "H"}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"scale", " ", "factor", " ", "and", " ", "Hubble", " ", "factor"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R", "'"}], "[", "t_", "]"}], ":=", 
  RowBox[{
   RowBox[{"H", "[", "t", "]"}], 
   RowBox[{"R", "[", "t", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R", "''"}], "[", "t_", "]"}], ":=", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"H", "[", "t", "]"}], 
     RowBox[{"R", "[", "t", "]"}]}], ",", "t"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8784422688576365`*^9, 3.878442331515673*^9}, {
  3.878694982543233*^9, 3.8786949829106083`*^9}, {3.880539494110523*^9, 
  3.88053952353281*^9}},
 CellLabel->
  "In[420]:=",ExpressionUUID->"be0753d3-fe97-4118-9209-8737914c791f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DefTensor", "[", 
   RowBox[{
    RowBox[{"v", "[", "a", "]"}], ",", "M"}], "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{"covariant", " ", "index"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"v", "[", "a", "]"}]}], "Input",
 CellChangeTimes->{{3.878441747118975*^9, 3.8784417531515226`*^9}, {
  3.8786931765120354`*^9, 3.878693185782171*^9}},
 CellLabel->
  "In[424]:=",ExpressionUUID->"ad07d713-e710-467d-8439-09d85acb5856"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DefTensor", "[", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"-", "a"}], "]"}], ",", "M"}], "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{"contravariant", " ", "index"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"w", "[", 
  RowBox[{"-", "a"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8784417943463917`*^9, 3.8784418030882864`*^9}, {
  3.8786932429640408`*^9, 3.878693250645233*^9}},
 CellLabel->
  "In[426]:=",ExpressionUUID->"a979736e-9f16-4f65-b62a-30e4fbd0f8f7"],

Cell["we can define (anti-)symmetric tensors easily.", "Text",
 CellChangeTimes->{{3.8786933060506706`*^9, 3.878693325449862*^9}, {
   3.8786976060094132`*^9, 3.878697606919532*^9}, 
   3.8805314929323816`*^9},ExpressionUUID->"f2695a11-485f-409a-9aa8-\
d175c24f907e"],

Cell[BoxData[{
 RowBox[{"DefTensor", "[", 
  RowBox[{
   RowBox[{"F", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}], ",", "M", ",", 
   RowBox[{"Symmetric", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "b"}]}], "}"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"F", "[", 
  RowBox[{
   RowBox[{"-", "a"}], ",", 
   RowBox[{"-", "b"}]}], "]"}]}], "Input",
 CellChangeTimes->{
  3.8784417834351845`*^9, {3.8784418656554127`*^9, 3.878441866430529*^9}},
 CellLabel->
  "In[428]:=",ExpressionUUID->"1892c5fb-78b5-4106-a24b-e6d25f65caa2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"F", "[", 
   RowBox[{
    RowBox[{"-", "b"}], ",", 
    RowBox[{"-", "a"}]}], "]"}], "//", "ToCanonical"}]], "Input",
 CellChangeTimes->{{3.8784418290754776`*^9, 3.878441831370185*^9}, {
  3.878441890275017*^9, 3.8784418906610756`*^9}},
 CellLabel->
  "In[430]:=",ExpressionUUID->"796a44bd-30ea-48df-9b09-2a2c7b51f80e"],

Cell[BoxData[{
 RowBox[{"DefTensor", "[", 
  RowBox[{
   RowBox[{"G", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}], ",", "M", ",", 
   RowBox[{"Antisymmetric", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "b"}]}], "}"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"G", "[", 
  RowBox[{
   RowBox[{"-", "a"}], ",", 
   RowBox[{"-", "b"}]}], "]"}]}], "Input",
 CellChangeTimes->{
  3.878441810897238*^9, {3.878441900572956*^9, 3.8784419047638454`*^9}},
 CellLabel->
  "In[431]:=",ExpressionUUID->"003b8da8-8cbd-4612-bf95-4305ab1db83c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"G", "[", 
   RowBox[{
    RowBox[{"-", "b"}], ",", 
    RowBox[{"-", "a"}]}], "]"}], "//", "ToCanonical"}]], "Input",
 CellChangeTimes->{3.878441911963826*^9},
 CellLabel->
  "In[433]:=",ExpressionUUID->"ebbba7ef-1470-4c8d-82bf-c00da115f3ef"],

Cell["\<\
The Mathematica\[CloseCurlyQuote]s standard function \
\[OpenCurlyQuote]Simplify\[CloseCurlyQuote] does not carry out full tensor \
manipulation. Instead, we use \[OpenCurlyQuote]ToCanonical.\[CloseCurlyQuote]\
\
\>", "Text",
 CellChangeTimes->{{3.8786933304108744`*^9, 3.878693383410381*^9}, {
  3.8786934146977797`*^9, 3.8786934366619654`*^9}, {3.8805335963093176`*^9, 
  3.88053359745298*^9}},ExpressionUUID->"603327c6-453e-462a-a1d4-\
029616f380ec"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"v", "[", "a", "]"}], 
   RowBox[{"v", "[", "b", "]"}], 
   RowBox[{"G", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{
  3.8785163189821424`*^9, {3.8786932671068344`*^9, 3.8786932701186085`*^9}},
 CellLabel->
  "In[434]:=",ExpressionUUID->"619557a4-d2d2-4963-b8e4-0b99eef281e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"v", "[", "a", "]"}], 
   RowBox[{"v", "[", "b", "]"}], 
   RowBox[{"G", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}]}], "//", "ToCanonical"}]], "Input",
 CellChangeTimes->{{3.8784419469706645`*^9, 3.87844195693307*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"7ee81f5e-25c1-470d-9c19-0b4c51de1c75"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"v", "[", "a", "]"}], 
     RowBox[{"v", "[", "b", "]"}], 
     RowBox[{"F", "[", 
      RowBox[{
       RowBox[{"-", "a"}], ",", 
       RowBox[{"-", "b"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"v", "[", "a", "]"}], 
     RowBox[{"v", "[", "c", "]"}], 
     RowBox[{"F", "[", 
      RowBox[{
       RowBox[{"-", "a"}], ",", 
       RowBox[{"-", "c"}]}], "]"}]}]}], ")"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.8784420093961906`*^9, 3.878442106523788*^9}},
 CellLabel->
  "In[435]:=",ExpressionUUID->"ac1d07a0-0186-4ce7-99e5-dbea357d21b9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"v", "[", "a", "]"}], 
     RowBox[{"v", "[", "b", "]"}], 
     RowBox[{"F", "[", 
      RowBox[{
       RowBox[{"-", "a"}], ",", 
       RowBox[{"-", "b"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"v", "[", "a", "]"}], 
     RowBox[{"v", "[", "c", "]"}], 
     RowBox[{"F", "[", 
      RowBox[{
       RowBox[{"-", "a"}], ",", 
       RowBox[{"-", "c"}]}], "]"}]}]}], ")"}], "//", "ToCanonical"}]], "Input",\

 CellChangeTimes->{3.878442115437298*^9},
 CellLabel->"In[24]:=",ExpressionUUID->"c81ed5c1-6ca4-4353-acca-ecbc5cc0c534"]
}, Open  ]],

Cell[CellGroupData[{

Cell["chart and coordinates", "Subsection",
 CellChangeTimes->{{3.8786962504474907`*^9, 
  3.878696270301343*^9}},ExpressionUUID->"d8436233-bb2f-443d-810b-\
71311ff45043"],

Cell["\<\
To convey computations under a specific coordinates, we use \
\[OpenCurlyQuote]DefChart\[CloseCurlyQuote] function.\
\>", "Text",
 CellChangeTimes->{{3.8786934471815076`*^9, 3.878693456758151*^9}, {
  3.8786937555342193`*^9, 
  3.8786938095882235`*^9}},ExpressionUUID->"81802b4d-1b89-439b-be0c-\
d282576e4946"],

Cell[BoxData[
 RowBox[{"Quiet", "@", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "Print", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DefChart", "[", 
      RowBox[{"Cartesian", ",", "M", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "2", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"t", "[", "]"}], ",", 
         RowBox[{"x", "[", "]"}], ",", 
         RowBox[{"y", "[", "]"}], ",", 
         RowBox[{"z", "[", "]"}]}], "}"}], ",", 
       RowBox[{"ChartColor", "->", "Green"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DefChart", "[", 
      RowBox[{"Spherical", ",", "M", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "2", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"t", "[", "]"}], ",", 
         RowBox[{"r", "[", "]"}], ",", 
         RowBox[{"\[Theta]", "[", "]"}], ",", 
         RowBox[{"\[Phi]", "[", "]"}]}], "}"}], ",", 
       RowBox[{"ChartColor", "->", "Red"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.878442183233612*^9, 3.878442200260235*^9}, 
   3.8784425386083093`*^9, 3.8786081489498577`*^9, {3.878608180923828*^9, 
   3.8786082093804812`*^9}, {3.8786082437397776`*^9, 
   3.8786082461981354`*^9}, {3.8805315565749717`*^9, 3.88053156593579*^9}, 
   3.8806678935448875`*^9},
 CellLabel->
  "In[436]:=",ExpressionUUID->"8b5a8cb2-fdfa-4edc-af18-575e29e05455"],

Cell["\<\
Under the given chart, we can now assign matrix components for tensors.\
\>", "Text",
 CellChangeTimes->{{3.878693828682094*^9, 
  3.8786938549663305`*^9}},ExpressionUUID->"18591647-7e18-408a-aacf-\
f94bddded94b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"matrixComponent", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"t", "[", "]"}], "]"}], ",", 
       RowBox[{"Y", "[", 
        RowBox[{"t", "[", "]"}], "]"}], ",", 
       RowBox[{"Y", "[", 
        RowBox[{"t", "[", "]"}], "]"}], ",", 
       RowBox[{"Y", "[", 
        RowBox[{"t", "[", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Y", "[", 
        RowBox[{"t", "[", "]"}], "]"}], ",", 
       RowBox[{"X", "[", 
        RowBox[{"t", "[", "]"}], "]"}], ",", "0", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Y", "[", 
        RowBox[{"t", "[", "]"}], "]"}], ",", "0", ",", 
       RowBox[{"X", "[", 
        RowBox[{"t", "[", "]"}], "]"}], ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Y", "[", 
        RowBox[{"t", "[", "]"}], "]"}], ",", "0", ",", "0", ",", 
       RowBox[{"X", "[", 
        RowBox[{"t", "[", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"matrixComponent", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.878442603558959*^9, 3.8784426624586816`*^9}, {
   3.878442739859109*^9, 3.8784427448444433`*^9}, 3.8784427899139795`*^9, {
   3.878443107524616*^9, 3.8784431113316298`*^9}, {3.8785163590214777`*^9, 
   3.8785163822130346`*^9}, {3.878516461440447*^9, 3.8785164660123367`*^9}, 
   3.8785171608198757`*^9},
 CellLabel->
  "In[437]:=",ExpressionUUID->"5df5c7f2-0ecb-4bbb-b1e9-eb9283cd894b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"F", "[", 
   RowBox[{
    RowBox[{"-", "a"}], ",", 
    RowBox[{"-", "b"}]}], "]"}], "//", "ComponentArray", " ", 
  RowBox[{"(*", 
   RowBox[{
   "component", " ", "array", " ", "before", " ", "chart", " ", 
    "declaration"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.878442843650264*^9, 3.87844285483328*^9}, {
  3.8786938781984997`*^9, 3.8786938921029587`*^9}},
 CellLabel->
  "In[439]:=",ExpressionUUID->"88e33281-9f83-4736-a0a3-7df429f8d772"],

Cell[BoxData[
 RowBox[{
  RowBox[{"F", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "Cartesian"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "b"}], ",", 
      RowBox[{"-", "Cartesian"}]}], "}"}]}], "]"}], "//", "ComponentArray", 
  " ", 
  RowBox[{"(*", 
   RowBox[{
   "component", " ", "array", " ", "under", " ", "Cartesian", " ", 
    "coordinates"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.8786938982207985`*^9, 3.8786939192877536`*^9}},
 CellLabel->
  "In[440]:=",ExpressionUUID->"717af38a-84a9-4a6e-b2eb-ff43f570c054"],

Cell[BoxData[
 RowBox[{"%", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.878698716764061*^9, 3.8786987208108206`*^9}},
 CellLabel->
  "In[441]:=",ExpressionUUID->"432c95fa-b161-4975-8cee-e42468c29b0a"],

Cell["we use \[OpenCurlyQuote]ComponentValue\[CloseCurlyQuote] to assign \
values.", "Text",
 CellChangeTimes->{{3.8786941384781456`*^9, 
  3.8786941811731606`*^9}},ExpressionUUID->"bfa46b17-e47d-4c62-b9b4-\
f5314e5ab4f9"],

Cell[BoxData[
 RowBox[{"ComponentValue", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "a"}], ",", 
        RowBox[{"-", "Cartesian"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "b"}], ",", 
        RowBox[{"-", "Cartesian"}]}], "}"}]}], "]"}], "//", 
    "ComponentArray"}], ",", "matrixComponent"}], "]"}]], "Input",
 CellChangeTimes->{{3.8784427821385264`*^9, 3.8784427865924644`*^9}, 
   3.8784430431389875`*^9, 3.87844308538591*^9},
 CellLabel->
  "In[442]:=",ExpressionUUID->"52b05ddd-13d0-48de-8a85-750ad8baa3d3"],

Cell[BoxData[
 RowBox[{"ComponentValue", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"G", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "a"}], ",", 
        RowBox[{"-", "Cartesian"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "b"}], ",", 
        RowBox[{"-", "Cartesian"}]}], "}"}]}], "]"}], "//", 
    "ComponentArray"}], ",", "matrixComponent"}], "]"}]], "Input",
 CellChangeTimes->{3.878443129200684*^9},
 CellLabel->
  "In[443]:=",ExpressionUUID->"721191ac-7082-458e-9f73-2f0166af3c09"],

Cell[BoxData[
 RowBox[{"F", "[", 
  RowBox[{
   RowBox[{"-", "a"}], ",", 
   RowBox[{"-", "b"}]}], "]"}]], "Input",
 CellLabel->
  "In[444]:=",ExpressionUUID->"b6dfa158-bdde-462a-ba09-ea44fe0f1146"],

Cell["We cannot show values without a specific coordinates. ", "Text",
 CellChangeTimes->{{3.8786976330538516`*^9, 3.8786976696569724`*^9}, {
  3.8806634274592004`*^9, 
  3.88066342845371*^9}},ExpressionUUID->"bb9bf555-3b7c-44a3-bd7b-\
d40f2582ca97"],

Cell[BoxData[
 RowBox[{"F", "[", 
  RowBox[{
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8785202989565816`*^9, 3.8785203001020584`*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"2d24c5f6-b84a-4e8c-93a5-023b227e11f6"],

Cell["To set coordinates, we use \[OpenCurlyQuote]ToBasis\[CloseCurlyQuote] \
function.", "Text",
 CellChangeTimes->{{3.8786942055223737`*^9, 
  3.8786942251586*^9}},ExpressionUUID->"f0f3cb9a-465f-4e9e-9031-5c1e60d24a29"],

Cell[BoxData[
 RowBox[{
  RowBox[{"F", "[", 
   RowBox[{
    RowBox[{"-", "a"}], ",", 
    RowBox[{"-", "b"}]}], "]"}], "//", 
  RowBox[{"ToBasis", "[", "Cartesian", "]"}]}]], "Input",
 CellChangeTimes->{3.8785202795200667`*^9},
 CellLabel->"In[35]:=",ExpressionUUID->"3eda24ef-f83a-4310-9ca5-505d6f47d222"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"F", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}], "//", 
   RowBox[{"ToBasis", "[", "Cartesian", "]"}]}], "//", 
  "ComponentArray"}]], "Input",
 CellChangeTimes->{{3.8785203412807846`*^9, 3.87852036261086*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"416868de-42bc-4030-ac2a-f3ebfbcffab8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "b"}]}], "]"}], "//", 
    RowBox[{"ToBasis", "[", "Cartesian", "]"}]}], "//", "ComponentArray"}], "//",
   "ToValues"}]], "Input",
 CellChangeTimes->{{3.878520519474876*^9, 3.8785205344388227`*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"806e5f3e-88cd-4dba-aabc-3533406ce4e1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "b"}]}], "]"}], "//", 
    RowBox[{"ToBasis", "[", "Cartesian", "]"}]}], "//", "ComponentArray"}], "//",
   "ToValues"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "note", " ", "that", " ", "Mathematica", " ", "matrix", " ", "indices", 
     " ", "begin", " ", "with", " ", "1"}], ",", 
    RowBox[{"not", " ", 
     RowBox[{"0", "!"}]}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8785205597094746`*^9, 3.8785205720408163`*^9}, {
  3.8785206097767735`*^9, 3.8785206425400944`*^9}, {3.8786942774992943`*^9, 
  3.8786942824533205`*^9}, {3.878694318780955*^9, 3.8786943411001587`*^9}, {
  3.8806660239483347`*^9, 3.880666036215489*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"76ad6591-62eb-4ee0-9bc5-669a7884da17"],

Cell["\<\
Let us put things together!

\:203b For those who wonder why we apply \[OpenCurlyQuote]ToValues\
\[CloseCurlyQuote] function many times:
in fact it depends on the situation. Since xAct package does not support \
auto-evaluation function like \[OpenCurlyQuote]Evaluate\[CloseCurlyQuote] in \
Mathematica, we need to iterate \[OpenCurlyQuote]ToValues\[CloseCurlyQuote] \
to fully evaluate every component of a tensor. For most cases, it suffices to \
apply twice or triple.
You may modify \[OpenCurlyQuote]MyArrayComponents\[CloseCurlyQuote] to see \
how the output varies by changing the number of iterations.\
\>", "Text",
 CellChangeTimes->{{3.878694389443598*^9, 3.8786943969339113`*^9}, {
  3.880532442979274*^9, 
  3.880532456760911*^9}},ExpressionUUID->"868f9c9c-efb7-4c98-825f-\
1884195ec551"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyArrayComponents", "[", "expr_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"expr", "//", 
         RowBox[{"ToBasis", "[", "Cartesian", "]"}]}], "//", 
        "ComponentArray"}], "//", "ToValues"}], "//", "ToValues"}], "//", 
     "ToValues"}], "//", "Simplify"}], "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.8784432249037066`*^9, 3.8784432266653457`*^9}, {
   3.878443269563985*^9, 3.8784432720864935`*^9}, {3.878520660982552*^9, 
   3.8785206759326534`*^9}, 3.878521111768441*^9, 3.878526655852072*^9, 
   3.8785272917796063`*^9},
 CellLabel->
  "In[445]:=",ExpressionUUID->"602008dd-4e13-4376-a4df-e88c1998c513"],

Cell[BoxData[
 RowBox[{
  RowBox[{"F", "[", 
   RowBox[{
    RowBox[{"-", "a"}], ",", 
    RowBox[{"-", "b"}]}], "]"}], "//", "MyArrayComponents"}]], "Input",
 CellChangeTimes->{{3.8784432497137723`*^9, 3.8784432508220835`*^9}},
 CellLabel->
  "In[446]:=",ExpressionUUID->"d08541db-a7db-487d-97ef-04780de81b30"],

Cell["\<\
Note that matrix components are automatically changed to follow previously \
declared rules.\
\>", "Text",
 CellChangeTimes->{{3.8786944087339087`*^9, 3.878694425732565*^9}, {
  3.878694682034937*^9, 3.8786946896139555`*^9}, {3.8786947251583543`*^9, 
  3.878694736850579*^9}},ExpressionUUID->"5c44f300-3182-4289-afb1-\
7a1f551c026d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"G", "[", 
   RowBox[{
    RowBox[{"-", "a"}], ",", 
    RowBox[{"-", "b"}]}], "]"}], "//", "MyArrayComponents"}]], "Input",
 CellChangeTimes->{3.878443284474581*^9},
 CellLabel->
  "In[447]:=",ExpressionUUID->"cc3ac4f4-0bab-408f-95e5-3b15a7fb5ff2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"F", "[", 
   RowBox[{"a", ",", 
    RowBox[{"-", "b"}]}], "]"}], "//", "MyArrayComponents"}]], "Input",
 CellChangeTimes->{3.8784432937446814`*^9},
 CellLabel->
  "In[448]:=",ExpressionUUID->"8c477ad5-6332-4177-9122-ea5b146fe523"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"metricMatrix", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"R", "[", 
         RowBox[{"t", "[", "]"}], "]"}], "^", "2"}], ",", "0", ",", "0"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{
        RowBox[{"R", "[", 
         RowBox[{"t", "[", "]"}], "]"}], "^", "2"}], ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"R", "[", 
         RowBox[{"t", "[", "]"}], "]"}], "^", "2"}]}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"metricMatrix", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8784433332669463`*^9, 3.8784434091528177`*^9}, {
  3.8785162775504956`*^9, 3.8785162809729376`*^9}, {3.8785171865386434`*^9, 
  3.8785171910306263`*^9}, {3.878694972873129*^9, 3.8786949790268126`*^9}},
 CellLabel->
  "In[449]:=",ExpressionUUID->"1f8dba7c-ff86-4c6e-916b-c7e20157a36a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["metric, covariant derivatives, curvature", "Subsection",
 CellChangeTimes->{{3.87869628665676*^9, 
  3.8786963143698187`*^9}},ExpressionUUID->"31a7b9a7-20eb-41a7-86f9-\
c35999236126"],

Cell["Let us define metric tensor under Cartesian coordinates.", "Text",
 CellChangeTimes->{{3.878694843407898*^9, 3.8786948484121485`*^9}, {
  3.878694941242569*^9, 3.878694967144692*^9}, {3.8786950106154413`*^9, 
  3.8786950205455203`*^9}},ExpressionUUID->"62ac10f5-1a7d-4157-8677-\
9d2476b0acf9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DefMetric", "[", 
   RowBox[{
    RowBox[{"-", "1"}], ",", 
    RowBox[{"g", "[", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "b"}]}], "]"}], ",", "covd", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<;\>\"", ",", "\"\<\[Del]\>\""}], "}"}], ",", 
    RowBox[{"PrintAs", "->", "\"\<g\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "@", 
  RowBox[{"MetricInBasis", "[", 
   RowBox[{"g", ",", 
    RowBox[{"-", "Cartesian"}], ",", "metricMatrix"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.878443422132617*^9, 3.878443450454014*^9}, {
   3.878443667259985*^9, 3.8784436694090333`*^9}, {3.878511022678217*^9, 
   3.8785110552317815`*^9}, {3.878518107505068*^9, 3.8785181085968976`*^9}, {
   3.8785182931893167`*^9, 3.8785182954633255`*^9}, 3.878519775327985*^9, 
   3.878519857839449*^9, {3.8785208015973644`*^9, 3.878520807152789*^9}, {
   3.8785208613012724`*^9, 3.878520864669815*^9}, {3.878520905327738*^9, 
   3.8785209058235054`*^9}, 3.8786992830695806`*^9},
 CellLabel->
  "In[451]:=",ExpressionUUID->"22d32f46-60c8-4ad8-8ee9-e45b24ba02d6"],

Cell[BoxData[
 RowBox[{"MetricCompute", "[", 
  RowBox[{"g", ",", "Cartesian", ",", "All"}], "]"}]], "Input",
 CellChangeTimes->{
  3.8785157684243336`*^9, {3.878606758053813*^9, 3.8786067587443113`*^9}},
 CellLabel->
  "In[453]:=",ExpressionUUID->"f2a3d2d9-cb52-488a-a755-570ebaad6ca3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"g", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "Cartesian"}], "}"}], ",", 
    RowBox[{"-", 
     RowBox[{"{", 
      RowBox[{"b", ",", "Cartesian"}], "}"}]}]}], "]"}], "//", 
  "MyArrayComponents"}]], "Input",
 CellChangeTimes->{{3.8785153346256275`*^9, 3.8785153641823435`*^9}, {
   3.8785156702376785`*^9, 3.878515671819557*^9}, 3.8786994231002965`*^9},
 CellLabel->
  "In[454]:=",ExpressionUUID->"f028dfc8-5db9-4ad2-bd61-d8bca86e904d"],

Cell["\<\
Tensor indices cannot be automatically raised or lowered. To make this \
operations possible, we have to use \[OpenCurlyQuote]ChangeComponents\
\[CloseCurlyQuote] function.
ChangeComponents[B,A] defines B from A, metric and rules.\
\>", "Text",
 CellChangeTimes->{{3.8786950449103775`*^9, 3.8786950728783226`*^9}, {
  3.8786951160601006`*^9, 3.8786951377571406`*^9}, {3.87869530193393*^9, 
  3.8786953053723764`*^9}, {3.8786953373893223`*^9, 
  3.878695426412132*^9}},ExpressionUUID->"1417ff20-77be-42ee-ba7d-\
b037be7617bd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChangeComponents", "[", 
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "Cartesian"}], "}"}], ",", 
       RowBox[{"-", 
        RowBox[{"{", 
         RowBox[{"b", ",", "Cartesian"}], "}"}]}]}], "]"}], ",", 
     RowBox[{"F", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"{", 
         RowBox[{"a", ",", "Cartesian"}], "}"}]}], ",", 
       RowBox[{"-", 
        RowBox[{"{", 
         RowBox[{"b", ",", "Cartesian"}], "}"}]}]}], "]"}]}], "]"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ChangeComponents", "[", 
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"{", 
         RowBox[{"a", ",", "Cartesian"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "Cartesian"}], "}"}]}], "]"}], ",", 
     RowBox[{"F", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"{", 
         RowBox[{"a", ",", "Cartesian"}], "}"}]}], ",", 
       RowBox[{"-", 
        RowBox[{"{", 
         RowBox[{"b", ",", "Cartesian"}], "}"}]}]}], "]"}]}], "]"}], ";"}], 
  " "}]}], "Input",
 CellChangeTimes->{{3.878443486561592*^9, 3.878443536463979*^9}, {
  3.878511131574609*^9, 3.8785111383717375`*^9}},
 CellLabel->
  "In[455]:=",ExpressionUUID->"a9bd6be1-ef36-48f8-9478-b30238c00a3e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"F", "[", 
   RowBox[{
    RowBox[{"-", "a"}], ",", "b"}], "]"}], "//", 
  "MyArrayComponents"}]], "Input",
 CellChangeTimes->{{3.8785151043216925`*^9, 3.878515164842186*^9}, {
  3.878521061275028*^9, 3.878521105115943*^9}, {3.878521148326408*^9, 
  3.878521164591607*^9}, {3.878526620546524*^9, 3.8785266787410407`*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"8340b430-3e8d-4f37-bfe3-a29d7b7fd57c"],

Cell["\<\
Note that metric compatibility is naturally satisfied because \[Del] is \
defined from the metric.\
\>", "Text",
 CellChangeTimes->{{3.8786954401733484`*^9, 3.8786954649168773`*^9}, {
  3.878695525056608*^9, 
  3.8786955367118387`*^9}},ExpressionUUID->"c248ae9d-fa32-499c-8427-\
510ce20ae94f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"covd", "[", "c", "]"}], "@", 
  RowBox[{"g", "[", 
   RowBox[{"a", ",", "b"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.878517215889077*^9, 3.8785173059379544`*^9}, {
  3.878517420526091*^9, 3.8785174322966194`*^9}, {3.8785179029594717`*^9, 
  3.8785179161419926`*^9}, {3.878518249561684*^9, 3.878518267148551*^9}, {
  3.8785187068571777`*^9, 3.878518715610342*^9}, {3.8785190530362763`*^9, 
  3.8785190746078653`*^9}, {3.878520917270043*^9, 3.878520933753455*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"5981030a-3499-4dce-a544-be5251d4b457"],

Cell["We can also obtain curvature tensors directly.", "Text",
 CellChangeTimes->{{3.87869634020825*^9, 
  3.8786963692561855`*^9}},ExpressionUUID->"e1601355-8b35-40db-ab4e-\
e1c04728c264"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Riccicovd", "[", 
   RowBox[{
    RowBox[{"-", "a"}], ",", 
    RowBox[{"-", "b"}]}], "]"}], "//", 
  "MyArrayComponents"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Einsteincovd", "[", 
   RowBox[{
    RowBox[{"-", "a"}], ",", 
    RowBox[{"-", "b"}]}], "]"}], "//", "MyArrayComponents"}]}], "Input",
 CellChangeTimes->{{3.878606687246955*^9, 3.8786066891505995`*^9}, {
   3.878606767951049*^9, 3.8786067812672243`*^9}, 3.8786068223643775`*^9, {
   3.8786068694480968`*^9, 3.878606875495844*^9}, {3.8786963736261597`*^9, 
   3.8786963786610737`*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"999e8a58-31d8-4b2a-a0ca-5b1293ae3444"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rule-based computation", "Subsection",
 CellChangeTimes->{{3.878696230023107*^9, 
  3.87869623487403*^9}},ExpressionUUID->"f685c3cd-e0a4-403b-8c2e-\
dd632e942ad4"],

Cell["However, we cannot evaluate derivatives in general. ", "Text",
 CellChangeTimes->{{3.878695562951761*^9, 3.8786955811869297`*^9}, {
  3.8786956318167267`*^9, 
  3.878695655541286*^9}},ExpressionUUID->"9c6344c7-9012-40fa-b03a-\
266e8521749e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"matrixComponent2", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"t", "[", "]"}], "]"}], ",", "0", ",", "0", ",", "0"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"X", "[", 
        RowBox[{"t", "[", "]"}], "]"}], ",", "0", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"X", "[", 
        RowBox[{"t", "[", "]"}], "]"}], ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{"X", "[", 
        RowBox[{"t", "[", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"matrixComponent2", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"ComponentValue", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"{", 
        RowBox[{"a", ",", "Cartesian"}], "}"}]}], ",", 
      RowBox[{"-", 
       RowBox[{"{", 
        RowBox[{"b", ",", "Cartesian"}], "}"}]}]}], "]"}], "//", 
    "ComponentArray"}], ",", "matrixComponent2"}], "]"}]}], "Input",
 CellChangeTimes->{{3.878525988377796*^9, 3.878525998833189*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"268d8c4a-b4e4-476e-81cd-982360c9da53"],

Cell[BoxData[
 RowBox[{
  RowBox[{"covd", "[", "a", "]"}], "@", 
  RowBox[{"F", "[", 
   RowBox[{
    RowBox[{"-", "a"}], ",", 
    RowBox[{"-", "b"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8785192291223674`*^9, 3.878519235977563*^9}, {
   3.8785193724309797`*^9, 3.8785194872456493`*^9}, {3.878519546313378*^9, 
   3.878519564969388*^9}, 3.8785196684714355`*^9, {3.878521192174752*^9, 
   3.8785213449336667`*^9}, {3.878521379301849*^9, 3.8785214785460415`*^9}, {
   3.878521576250223*^9, 3.8785215769789886`*^9}, {3.878526139538625*^9, 
   3.878526141667266*^9}, {3.878527331467764*^9, 3.878527338432767*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"da7e91ea-2994-4b8a-ad19-a771fafdd04f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"covd", "[", "a", "]"}], "@", 
   RowBox[{"F", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}]}], "//", "MyArrayComponents"}]], "Input",
 CellChangeTimes->{{3.8811316833126745`*^9, 3.8811316996535125`*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"05ca15c3-aa2a-4f9a-99dc-de79b591ff97"],

Cell["But we may compute Christoffel symbols ", "Text",
 CellChangeTimes->{{3.8786959768998237`*^9, 3.8786959815824366`*^9}, {
  3.8786960967198133`*^9, 3.8786961048054047`*^9}, {3.878696179071705*^9, 
  3.8786962068409014`*^9}},ExpressionUUID->"5a0eedfd-aeff-428b-995b-\
bb5167dfefcb"],

Cell[BoxData[{
 RowBox[{"ChristoffelcovdPDCartesian", "[", 
  RowBox[{"a", ",", 
   RowBox[{"-", "b"}], ",", 
   RowBox[{"-", "c"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MyArrayComponents"}]}], "Input",
 CellChangeTimes->{{3.878603345690939*^9, 3.878603371887576*^9}, {
  3.8786034027534904`*^9, 3.878603404134772*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"c44fa670-71d0-4073-94c1-650a05689627"],

Cell["\<\
Although the evaluation with \[OpenCurlyQuote]CovDToChristoffel\
\[CloseCurlyQuote] does not give an useful value, it shows how we should \
assign values.\
\>", "Text",
 CellChangeTimes->{{3.878695944874158*^9, 3.8786959737210393`*^9}, {
   3.8786962090571856`*^9, 3.878696217965168*^9}, {3.8786963993756495`*^9, 
   3.8786964083900857`*^9}, 3.878697509353012*^9, {3.8805354005454626`*^9, 
   3.8805354509852295`*^9}},ExpressionUUID->"1866d622-51d6-487e-9bb3-\
4a2c5f1f5e2a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"covd", "[", "a", "]"}], "@", 
   RowBox[{"F", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}]}], "//", 
  "CovDToChristoffel"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "ignore", " ", "random", " ", "number", " ", "behind", " ", "dummy", " ", 
    RowBox[{"indices", ".", " ", "they"}], " ", "are", " ", "just", " ", 
    "internal", " ", "pointing", " ", 
    RowBox[{"values", "."}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.878606393150299*^9, 3.8786064281526794`*^9}, {
  3.878606571297014*^9, 3.878606574278761*^9}, {3.88066347452714*^9, 
  3.8806636136865463`*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"97470ce9-5060-4bd6-a1e3-eb7936baa409"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EvaluationOfCovD", "[", 
    RowBox[{
     RowBox[{"covd", "[", "a", "]"}], ",", 
     RowBox[{"F", "[", 
      RowBox[{
       RowBox[{"-", "a"}], ",", "b_"}], "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"index", "=", "b"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"coord", "[", "a_", "]"}], ":=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"t", "[", "]"}], ",", 
          RowBox[{"x", "[", "]"}], ",", 
          RowBox[{"y", "[", "]"}], ",", 
          RowBox[{"z", "[", "]"}]}], "}"}], "[", 
        RowBox[{"[", 
         RowBox[{"a", "+", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"MyChristoffel", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"ChristoffelcovdPDCartesian", "[", 
              RowBox[{"a", ",", 
               RowBox[{"-", "c"}], ",", 
               RowBox[{"-", "d"}]}], "]"}], "//", 
             RowBox[{"ToBasis", "[", "Cartesian", "]"}]}], "//", 
            "ComponentArray"}], "//", "ToValues"}], "//", "ToValues"}], "//", 
         "ToValues"}], "//", "Simplify"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "we", " ", "do", " ", "not", " ", "change", " ", "it", " ", "to", " ", 
        
        RowBox[{"MatrixForm", ".", " ", "otherwise"}], " ", "it", " ", "will",
         " ", "cause", " ", "unnessasary", " ", 
        RowBox[{"error", "."}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"result", "=", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Sum", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"MyChristoffel", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"d", "+", "1"}], ",", 
                  RowBox[{"a", "+", "1"}], ",", 
                  RowBox[{"index", "+", "1"}]}], "]"}], "]"}], 
               RowBox[{"ToValues", "@", 
                RowBox[{"F", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"a", ",", "Cartesian"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"d", ",", 
                    RowBox[{"-", "Cartesian"}]}], "}"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "0", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"d", ",", "0", ",", "3"}], "}"}]}], "]"}]}], "//", 
           "ToValues"}], "//", "Simplify"}], ")"}], "\[IndentingNewLine]", 
        "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Sum", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"g", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"a", ",", "Cartesian"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"c", ",", "Cartesian"}], "}"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"MyChristoffel", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"d", "+", "1"}], ",", 
                  RowBox[{"c", "+", "1"}], ",", 
                  RowBox[{"a", "+", "1"}]}], "]"}], "]"}], 
               RowBox[{"ToValues", "@", 
                RowBox[{"F", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"d", ",", 
                    RowBox[{"-", "Cartesian"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"index", ",", 
                    RowBox[{"-", "Cartesian"}]}], "}"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "0", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"c", ",", "0", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"d", ",", "0", ",", "3"}], "}"}]}], "]"}]}], "//", 
           "ToValues"}], "//", "Simplify"}], ")"}], "\[IndentingNewLine]", 
        "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Sum", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"g", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"a", ",", "Cartesian"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"c", ",", "Cartesian"}], "}"}]}], "]"}], 
              "\[IndentingNewLine]", 
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"ToValues", "@", 
                 RowBox[{"F", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"a", ",", 
                    RowBox[{"-", "Cartesian"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"index", ",", 
                    RowBox[{"-", "Cartesian"}]}], "}"}]}], "]"}]}], ",", 
                RowBox[{"coord", "[", "c", "]"}]}], "]"}]}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", "0", ",", "3"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"c", ",", "0", ",", "3"}], "}"}]}], "]"}], "//", 
           "ToValues"}], "//", "Simplify"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
      RowBox[{"result", "//", "Simplify"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8786975156560626`*^9, 3.8786975924578753`*^9}, {
   3.880533107684132*^9, 3.8805331497265024`*^9}, {3.8805331847963705`*^9, 
   3.880533203715725*^9}, {3.8805332934768085`*^9, 3.880533432969691*^9}, {
   3.8805339399735107`*^9, 3.8805340018102856`*^9}, {3.880534051017912*^9, 
   3.880534168127816*^9}, 3.8805342004816337`*^9, {3.8805343020353785`*^9, 
   3.880534370194389*^9}, {3.88053440425984*^9, 3.8805344328496857`*^9}, {
   3.880534515352578*^9, 3.88053451615299*^9}, {3.880534620492154*^9, 
   3.8805346322869663`*^9}, {3.880534731806235*^9, 3.8805347322240944`*^9}, {
   3.8805351193292537`*^9, 3.88053525862508*^9}, {3.880535321691471*^9, 
   3.880535344318961*^9}, 3.880535375295311*^9, {3.8805354935918446`*^9, 
   3.8805355342655897`*^9}, {3.880535571155136*^9, 3.880535572738714*^9}, 
   3.8805360673302345`*^9, {3.880536601037449*^9, 3.880536753998895*^9}, {
   3.880536792620372*^9, 3.8805368760020866`*^9}, {3.880536906152303*^9, 
   3.880536910237048*^9}, {3.880537084918499*^9, 3.880537205556616*^9}, {
   3.880537239044384*^9, 3.8805373039701805`*^9}, {3.8805373590663824`*^9, 
   3.8805373837518063`*^9}, {3.8805374175260167`*^9, 3.880537421856127*^9}, {
   3.8805375018695135`*^9, 3.880537843876862*^9}, {3.8805378964923444`*^9, 
   3.8805379288909473`*^9}, {3.880538021846759*^9, 3.880538024681939*^9}, {
   3.880538079408348*^9, 3.880538176870699*^9}, {3.8805382126173143`*^9, 
   3.8805382957134714`*^9}, {3.8805383259096365`*^9, 
   3.8805384794899063`*^9}, {3.880538747270789*^9, 3.8805387620958776`*^9}, {
   3.8805393498947706`*^9, 3.8805394308351483`*^9}, {3.880663326389037*^9, 
   3.880663340733373*^9}, {3.8806639465151434`*^9, 3.8806639694814987`*^9}, {
   3.880664009882024*^9, 3.8806640639272633`*^9}, {3.88066410652868*^9, 
   3.880664109283597*^9}, {3.880664250487561*^9, 3.8806642602480183`*^9}, {
   3.8806643030400934`*^9, 3.880664394544856*^9}, {3.8806644424933667`*^9, 
   3.8806644476785936`*^9}, {3.880664481777886*^9, 3.880664546215717*^9}, {
   3.8806651641833143`*^9, 3.8806651951496196`*^9}, {3.8806652288956995`*^9, 
   3.880665419179803*^9}, {3.880665517135337*^9, 3.8806655314267282`*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"dbefbb3d-a394-4db3-98e2-4f09e2c5be5c"],

Cell[BoxData[
 RowBox[{"EvaluationOfCovD", "[", 
  RowBox[{
   RowBox[{"covd", "[", "a", "]"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", "0"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8806654446411476`*^9, 3.8806654554408393`*^9}, {
  3.8806655510199547`*^9, 3.8806655582378955`*^9}, {3.8806673643718786`*^9, 
  3.8806673651425557`*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"1868aa5e-fbc6-4957-b22d-e1c1fa0b681a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["coordinates change", "Subsection",
 CellChangeTimes->{{3.878696419510785*^9, 
  3.8786964251083965`*^9}},ExpressionUUID->"0bb57c88-8a51-4363-b96e-\
0bc62e59f364"],

Cell["\<\
We can define a relation between two coordinates. Note that this may be \
exploited in tetrad formalism.\
\>", "Text",
 CellChangeTimes->{{3.8786964345297527`*^9, 3.878696505040985*^9}, {
  3.8786965470782876`*^9, 
  3.878696580400985*^9}},ExpressionUUID->"39b24fa2-7616-4650-8cdd-\
bc80f89280cb"],

Cell[BoxData[
 RowBox[{"Basis", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a", ",", "Cartesian"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "b"}], ",", 
     RowBox[{"-", "Spherical"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.878608345476559*^9, 3.8786083548328285`*^9}, {
  3.8786086278247805`*^9, 3.8786086317181473`*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"a99c89d5-5b2f-4edc-94e6-81ea3e28f416"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"x", "/:", 
   RowBox[{"InChart", "[", 
    RowBox[{
     RowBox[{"x", "[", "]"}], ",", "Spherical"}], "]"}], "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], ",", 
     RowBox[{"r", " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}], 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", "/:", 
   RowBox[{"InChart", "[", 
    RowBox[{
     RowBox[{"y", "[", "]"}], ",", "Spherical"}], "]"}], "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], ",", 
     RowBox[{"r", " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}], 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"z", "/:", 
   RowBox[{"InChart", "[", 
    RowBox[{
     RowBox[{"z", "[", "]"}], ",", "Spherical"}], "]"}], "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], ",", 
     RowBox[{"r", " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "/:", 
   RowBox[{"InChart", "[", 
    RowBox[{
     RowBox[{"r", "[", "]"}], ",", "Cartesian"}], "]"}], "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "}"}], ",", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"x", "^", "2"}], "+", 
       RowBox[{"y", "^", "2"}], "+", 
       RowBox[{"z", "^", "2"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]", "/:", 
   RowBox[{"InChart", "[", 
    RowBox[{
     RowBox[{"\[Theta]", "[", "]"}], ",", "Cartesian"}], "]"}], "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "}"}], ",", 
     RowBox[{"ArcCos", "[", 
      RowBox[{"z", "/", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"x", "^", "2"}], "+", 
         RowBox[{"y", "^", "2"}], "+", 
         RowBox[{"z", "^", "2"}]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]", "/:", 
   RowBox[{"InChart", "[", 
    RowBox[{
     RowBox[{"\[Phi]", "[", "]"}], ",", "Cartesian"}], "]"}], "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "}"}], ",", 
     RowBox[{"ArcTan", "[", 
      RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"And", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"t", "[", "]"}], ",", 
        RowBox[{"x", "[", "]"}], ",", 
        RowBox[{"y", "[", "]"}], ",", 
        RowBox[{"z", "[", "]"}], ",", 
        RowBox[{"r", "[", "]"}], ",", 
        RowBox[{"\[Phi]", "[", "]"}], ",", 
        RowBox[{"\[Theta]", "[", "]"}]}], "}"}], " ", "\[Element]", " ", 
      "Reals"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "[", "]"}], " ", "\[GreaterEqual]", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"0", "\[LessEqual]", " ", 
      RowBox[{"\[Theta]", "[", "]"}], "\[LessEqual]", " ", "Pi"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"0", "\[LessEqual]", " ", 
      RowBox[{"\[Phi]", "[", "]"}], "<", 
      RowBox[{"2", "Pi"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878608377552064*^9, 3.878608431855296*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"034f8dbb-7b86-4ef7-98b9-7c6511b8abcf"],

Cell["\<\
Let us check our function works well by conducting transformation and its \
inverse.\
\>", "Text",
 CellChangeTimes->{{3.8786966294651003`*^9, 
  3.8786966822943287`*^9}},ExpressionUUID->"708adb15-6acb-422a-9b59-\
fa583f6c0de7"],

Cell[BoxData[{
 RowBox[{"ScalarsOfChart", "[", "Cartesian", "]"}], "\n", 
 RowBox[{
  RowBox[{"InChart", "[", "Spherical", "]"}], "/@", 
  "%"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"InChart", "[", "Cartesian", "]"}], "/@", "%"}], ")"}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.8786084708419876`*^9, 3.8786084793319397`*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"92fcacbc-574f-4d74-9711-9577c33fba7e"],

Cell["\<\
We need an additional package to apply this to general tensors. \
\>", "Text",
 CellChangeTimes->{{3.8786967184492407`*^9, 3.878696724175028*^9}, {
  3.87869677334569*^9, 
  3.878696817899417*^9}},ExpressionUUID->"ff609591-f9ce-4c2e-b7f3-\
f810c468744f"],

Cell[BoxData[{
 RowBox[{"Quiet", "@", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "Print", "}"}], ",", 
    RowBox[{"<<", "xAct`xTras`"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"ComputeBasisValues", "[", 
   RowBox[{"Cartesian", ",", "Spherical"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8786084961402087`*^9, 3.8786085021968927`*^9}, {
  3.878609197832036*^9, 3.878609202933092*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"41871feb-be88-4c4a-906f-c2dc74d5134c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"F", "[", 
    RowBox[{
     RowBox[{"-", "a"}], ",", 
     RowBox[{"-", "b"}]}], "]"}], "//", 
   RowBox[{"ToBasis", "[", "Spherical", "]"}]}], "//", 
  "ComponentArray"}]], "Input",
 CellChangeTimes->{{3.878608546486638*^9, 3.8786085565218945`*^9}, {
   3.880661278422615*^9, 3.880661287955385*^9}, 3.880661399282195*^9, {
   3.8806614615210314`*^9, 3.8806614625689354`*^9}, {3.8806615622577953`*^9, 
   3.880661563476507*^9}, 3.880666103868791*^9},
 CellLabel->"In[79]:=",ExpressionUUID->"25b0dd3d-cb36-47b1-a137-1ea75103b0f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "b"}]}], "]"}], "//", 
    RowBox[{"ToBasis", "[", "Spherical", "]"}]}], "//", 
   RowBox[{"SeparateBasis", "[", "Cartesian", "]"}]}], "//", 
  "ComponentArray"}]], "Input",
 CellChangeTimes->{{3.8786085744686823`*^9, 3.878608575533222*^9}, {
  3.8786999002623696`*^9, 3.878699922564011*^9}, {3.8806613693653927`*^9, 
  3.880661370162261*^9}, {3.880661401688223*^9, 3.880661403537981*^9}, {
  3.8806614716190114`*^9, 3.8806615125589914`*^9}, {3.8806615710746346`*^9, 
  3.88066157409051*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"9743a92a-16f3-4a1a-9c24-413c39d3edad"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"F", "[", 
       RowBox[{
        RowBox[{"-", "a"}], ",", 
        RowBox[{"-", "b"}]}], "]"}], "//", 
      RowBox[{"ToBasis", "[", "Spherical", "]"}]}], "//", 
     RowBox[{"SeparateBasis", "[", "Cartesian", "]"}]}], "//", 
    "ComponentArray"}], "//", "TraceBasisDummy"}], "//", 
  "MyArrayComponents"}]], "Input",
 CellChangeTimes->{{3.8786085981849756`*^9, 3.8786086043475137`*^9}, 
   3.8806613046267266`*^9, {3.880661346498809*^9, 3.880661363975314*^9}, {
   3.88066152501641*^9, 3.880661531284771*^9}, {3.880661585968955*^9, 
   3.880661588772813*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"e8458fa1-5052-4d6a-9930-fd3f15f9cfcf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["CTensor: more convenient way to compute tensor components", "Subsection",
 CellChangeTimes->{{3.8786969770719643`*^9, 3.8786969792991457`*^9}, {
  3.878697029064788*^9, 
  3.878697041129177*^9}},ExpressionUUID->"511a4ed6-8fa1-4375-af86-\
a538d572d2e6"],

Cell[BoxData[{
 RowBox[{"removeAll", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"removeAll", ":=", 
   RowBox[{"Remove", "[", 
    RowBox[{"Evaluate", "[", 
     RowBox[{"$Context", "<>", "\"\<*\>\""}], "]"}], "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.880667038904756*^9, 3.8806670430867405`*^9}, {
   3.880667073585588*^9, 3.8806670754322395`*^9}, {3.880667572953598*^9, 
   3.880667573555255*^9}, 3.8806878135548997`*^9},
 CellLabel->"In[82]:=",ExpressionUUID->"981a74d2-f813-4f56-8b2c-b697f583f90b"],

Cell[BoxData[{
 RowBox[{"Quiet", "@", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "Print", "}"}], ",", 
    RowBox[{"<<", "xAct`xCoba`"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefManifold", "[", 
   RowBox[{"M", ",", "4", ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DefScalarFunction", "/@", 
    RowBox[{"{", 
     RowBox[{"X", ",", "R", ",", "H"}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"scale", " ", "factor", " ", "and", " ", "Hubble", " ", "factor"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R", "'"}], "[", "t_", "]"}], ":=", 
  RowBox[{
   RowBox[{"H", "[", "t", "]"}], 
   RowBox[{"R", "[", "t", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R", "''"}], "[", "t_", "]"}], ":=", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"H", "[", "t", "]"}], 
     RowBox[{"R", "[", "t", "]"}]}], ",", "t"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"metricMatrix", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"R", "[", 
         RowBox[{"t", "[", "]"}], "]"}], "^", "2"}], ",", "0", ",", "0"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{
        RowBox[{"R", "[", 
         RowBox[{"t", "[", "]"}], "]"}], "^", "2"}], ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"R", "[", 
         RowBox[{"t", "[", "]"}], "]"}], "^", "2"}]}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrixComponent", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"t", "[", "]"}], "]"}], ",", "0", ",", "0", ",", "0"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"X", "[", 
        RowBox[{"t", "[", "]"}], "]"}], ",", "0", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"X", "[", 
        RowBox[{"t", "[", "]"}], "]"}], ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{"X", "[", 
        RowBox[{"t", "[", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Quiet", "@", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "Print", "}"}], ",", 
     RowBox[{"DefChart", "[", 
      RowBox[{"Cartesian", ",", "M", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "2", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"t", "[", "]"}], ",", 
         RowBox[{"x", "[", "]"}], ",", 
         RowBox[{"y", "[", "]"}], ",", 
         RowBox[{"z", "[", "]"}]}], "}"}], ",", 
       RowBox[{"ChartColor", "->", "Green"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8786080371004677`*^9, 3.8786080391333246`*^9}, {
   3.8786087103987675`*^9, 3.8786087429254904`*^9}, {3.8786087755949955`*^9, 
   3.8786087771384754`*^9}, {3.8786088134493136`*^9, 3.878608841715769*^9}, {
   3.8787008659106083`*^9, 3.8787009366478615`*^9}, {3.880535991738028*^9, 
   3.8805359921096287`*^9}, {3.880536094454441*^9, 3.8805361099542847`*^9}, {
   3.8806656266020527`*^9, 3.8806656329872665`*^9}, {3.880665672010373*^9, 
   3.8806658012640505`*^9}, {3.8806658468152256`*^9, 3.880665900307789*^9}, {
   3.880666289854184*^9, 3.880666290186617*^9}, {3.880666344923194*^9, 
   3.8806663459073386`*^9}, 3.8806663924085293`*^9, {3.880666503057182*^9, 
   3.8806665038603363`*^9}, {3.880666561173339*^9, 3.880666672143775*^9}, {
   3.8806667171093645`*^9, 3.8806667178241625`*^9}, {3.8806668561274877`*^9, 
   3.8806668573282495`*^9}, {3.880666889649125*^9, 3.8806668909936447`*^9}, {
   3.88066693258416*^9, 3.880666935966401*^9}, {3.880667515403883*^9, 
   3.880667536914282*^9}, {3.880667569428015*^9, 3.8806676003322697`*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"fc240dd9-0ead-4fe9-8bfc-1e741174c64e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"CTensor", "[", 
    RowBox[{"metricMatrix", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "Cartesian"}], ",", 
       RowBox[{"-", "Cartesian"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8785158476454325`*^9, 3.878515875823542*^9}, {
  3.8785161836972733`*^9, 3.8785162070705757`*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"3605b44d-dc21-450a-adeb-f7aed4401bc3"],

Cell[BoxData[
 RowBox[{"g", "[", 
  RowBox[{
   RowBox[{"-", "a"}], ",", 
   RowBox[{"-", "b"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8785158928592167`*^9, 3.8785158948175116`*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"70e4a377-5ff1-4c3a-8249-d535ed7b3cb5"],

Cell[BoxData[
 RowBox[{"SetCMetric", "[", 
  RowBox[{"g", ",", "Cartesian", ",", 
   RowBox[{"SignatureOfMetric", "->", 
    RowBox[{"{", 
     RowBox[{"3", ",", "1", ",", "0"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8785162381423473`*^9, 3.87851624120829*^9}, {
  3.8785195910341835`*^9, 3.8785195932210283`*^9}, {3.8812953106918836`*^9, 
  3.8812953154757395`*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"7bf1a1c5-e3f8-45fa-9536-453b9b79d32f"],

Cell[BoxData[
 RowBox[{"g", "[", 
  RowBox[{"a", ",", "b"}], "]"}]], "Input",
 CellLabel->"In[95]:=",ExpressionUUID->"c409425d-5950-4ca8-8e48-0d77e13d5a7e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"F", "=", 
   RowBox[{"CTensor", "[", 
    RowBox[{"matrixComponent", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "Cartesian"}], ",", 
       RowBox[{"-", "Cartesian"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"F", "[", 
  RowBox[{
   RowBox[{"-", "a"}], ",", "b"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8785263960457063`*^9, 3.878526407915642*^9}, {
   3.878606912177287*^9, 3.878606912428155*^9}, 3.878608844646805*^9},
 CellLabel->"In[96]:=",ExpressionUUID->"09783538-5610-4175-955b-b6052527a84f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CD", "=", 
   RowBox[{"LC", "[", "g", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.878517997968173*^9, 3.8785180016366687`*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"0f0b3eb4-8e20-48ee-8737-2a34da85a0f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CD", "[", "c", "]"}], "@", 
  RowBox[{"g", "[", 
   RowBox[{"a", ",", "b"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8785180187397327`*^9, 3.878518032120391*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"674b68ef-f136-4c2f-b5bc-fcc127ccd125"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CD", "[", "a", "]"}], "@", 
  RowBox[{"F", "[", 
   RowBox[{
    RowBox[{"-", "a"}], ",", 
    RowBox[{"-", "b"}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.878518042527981*^9, {3.878519613591401*^9, 3.8785196212911186`*^9}, {
   3.8785264433804617`*^9, 3.878526444964407*^9}, {3.8805361484122066`*^9, 
   3.8805361518507137`*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"a0be5ca7-4fd9-46e7-b96b-8f3ff5a6808b"],

Cell["\<\
To show long complex components, we adjust display parameter.\
\>", "Text",
 CellChangeTimes->{{3.8786970704597893`*^9, 
  3.8786971124146767`*^9}},ExpressionUUID->"4ab2bdb2-9b55-49a8-9bd3-\
a77bcb77d1f4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xAct`xCoba`$LargeComponentSize", "=", "3000"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CD", "[", "a", "]"}], "@", 
  RowBox[{"F", "[", 
   RowBox[{
    RowBox[{"-", "a"}], ",", 
    RowBox[{"-", "b"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.878518067454246*^9, 3.8785180678273487`*^9}, {
  3.878526439135686*^9, 3.87852645267251*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"a2b106bb-273a-4a4a-b200-9afa82ac1a11"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Einstein", "[", "CD", "]"}], "[", 
  RowBox[{
   RowBox[{"-", "a"}], ",", "b"}], "]"}]], "Input",
 CellChangeTimes->{{3.878606969741296*^9, 3.8786069784392586`*^9}, {
   3.8786070202132587`*^9, 3.8786070251303444`*^9}, 3.878700980538729*^9},
 CellLabel->
  "In[103]:=",ExpressionUUID->"c9ee9406-303f-4d36-aac1-cf5069b7b7e9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Action principle", "Subsection",
 CellChangeTimes->{{3.878697122173241*^9, 3.8786971258791103`*^9}, {
  3.8806718220218406`*^9, 
  3.880671822530428*^9}},ExpressionUUID->"ccbbb18c-64fd-4ada-8962-\
c1bf0e820166"],

Cell[BoxData[{
 RowBox[{"removeAll", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"removeAll", ":=", 
   RowBox[{"Remove", "[", 
    RowBox[{"Evaluate", "[", 
     RowBox[{"$Context", "<>", "\"\<*\>\""}], "]"}], "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{
  3.8806675821378317`*^9, {3.8806722084350057`*^9, 3.880672240616049*^9}, {
   3.880674311444268*^9, 3.880674312214425*^9}, 3.8806861296513977`*^9, 
   3.880686182777521*^9, 3.880687799897301*^9},
 CellLabel->
  "In[260]:=",ExpressionUUID->"464b74ba-f630-4629-9846-4bde4a929f76"],

Cell[BoxData[{
 RowBox[{"Quiet", "@", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "Print", "}"}], ",", 
    RowBox[{
     RowBox[{"<<", "xAct`xTensor`"}], ";", 
     RowBox[{"<<", "xAct`xPert`"}], ";", 
     RowBox[{"<<", "xAct`xCoba`"}], ";"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"DefManifold", "[", 
  RowBox[{"M", ",", "4", ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.87860804954099*^9, 3.878608053797961*^9}, {
   3.8786089797078342`*^9, 3.8786089809448395`*^9}, {3.8806630585397043`*^9, 
   3.8806630619640613`*^9}, {3.8806669158295527`*^9, 3.880666924339141*^9}, 
   3.8806683641371593`*^9},
 CellLabel->
  "In[262]:=",ExpressionUUID->"0bc35958-1882-4463-80af-17a7fa15c52b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PerturbAction", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"g_", "?", "MetricQ"}], "[", 
      RowBox[{
       RowBox[{"a_", "?", "UpIndexQ"}], ",", 
       RowBox[{"b_", "?", "UpIndexQ"}]}], "]"}], "|", 
     RowBox[{
      RowBox[{"g_", "?", "MetricQ"}], "[", 
      RowBox[{
       RowBox[{"a_", "?", "DownIndexQ"}], ",", 
       RowBox[{"b_", "?", "DownIndexQ"}]}], "]"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pertexpr", ",", "res", ",", "dgloc", ",", 
      RowBox[{"(*", 
       RowBox[{"dummyloc", ","}], "*)"}], "hp"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "We", " ", "define", " ", "the", " ", "metric", " ", "perturbation"}], 
      ",", " ", 
      RowBox[{"if", " ", "not", " ", "defined", " ", "already"}]}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dgloc", "=", 
      RowBox[{"SymbolJoin", "[", 
       RowBox[{"\"\<\[Delta]\>\"", ",", "g"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"hp", "=", 
      RowBox[{"Head", "@", 
       RowBox[{"Perturbation", "[", 
        RowBox[{"g", "[", 
         RowBox[{
          RowBox[{"DownIndex", "@", "a"}], ",", 
          RowBox[{"DownIndex", "@", "b"}]}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"hp", "===", "Perturbation"}], ",", 
       RowBox[{"DefMetricPerturbation", "[", 
        RowBox[{"g", ",", "dgloc", ",", 
         RowBox[{"SymbolJoin", "[", 
          RowBox[{"\"\<\[Epsilon]\>\"", ",", "g"}], "]"}]}], "]"}], ",", 
       RowBox[{"dgloc", "=", "hp"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"$DefInfoQ", "=", "False"}], "}"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "We", " ", "perturb", " ", "wrt", " ", "to", " ", "the", " ", 
         "metric", " ", "and", " ", "if", " ", "it", " ", "is", " ", "the", 
         " ", "inverse", " ", "metric", " ", "we", " ", "put", " ", "a", " ", 
         "minus", " ", "sign"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pertexpr", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"DownIndexQ", "[", "a", "]"}], ",", "1", ",", 
              RowBox[{"-", "1"}]}], "]"}], ")"}], "*", 
           RowBox[{"ToCanonical", "@", 
            RowBox[{"ContractMetric", "@", 
             RowBox[{"ExpandPerturbation", "@", 
              RowBox[{"Perturbation", "[", "expr", "]"}]}]}]}]}], "/.", 
          RowBox[{
           RowBox[{"Perturbation", "[", "tens_", "]"}], "\[RuleDelayed]", 
           "0"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"We", " ", "then", " ", "use", " ", 
          RowBox[{"VarD", ".", " ", "It"}], " ", "happens", " ", "that", " ", 
          "some", " ", "trivial", " ", "Kronecker", " ", "appear", " ", 
          "which", " ", "need", " ", "to", " ", "be", " ", "handle", " ", 
          "manually"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"res", "=", 
         RowBox[{"ToCanonical", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"SameDummies", "@", 
             RowBox[{"ContractMetric", "@", 
              RowBox[{
               RowBox[{"VarD", "[", 
                RowBox[{
                 RowBox[{"dgloc", "[", 
                  RowBox[{
                   RowBox[{"LI", "[", "1", "]"}], ",", "a", ",", "b"}], "]"}],
                  ",", 
                 RowBox[{"CovDOfMetric", "[", "g", "]"}]}], "]"}], "[", 
               "pertexpr", "]"}]}]}], ")"}], "/.", 
           RowBox[{
            RowBox[{"delta", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"LI", "[", "n_", "]"}]}], ",", 
              RowBox[{"LI", "[", "m_", "]"}]}], "]"}], "\[RuleDelayed]", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{
              RowBox[{"NoScalar", "[", "n", "]"}], ",", 
              RowBox[{"NoScalar", "[", "m", "]"}]}], "]"}]}]}], "]"}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "res"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PerturbAction", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{"tensor_", "?", "xTensorQ"}], ",", "covd_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", ",", "dummyloc", ",", "pertexpr", ",", "inds"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"$DefInfoQ", "=", "False"}], "}"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "We", " ", "use", " ", "a", " ", "dummy", " ", "name", " ", "for", 
          " ", "the", " ", "variation", " ", "of", " ", "the", " ", 
          "tensor"}], ",", " ", 
         RowBox[{
         "and", " ", "use", " ", "it", " ", "to", " ", "replace", " ", "the", 
          " ", "formal", " ", "first", " ", "order", " ", "perturbation", " ",
           "the", " ", "tensor"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "So", " ", "first", " ", "we", " ", "define", " ", "this", " ", 
         "dummy", " ", "tensor"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dummyloc", "=", 
         RowBox[{"SymbolJoin", "[", 
          RowBox[{"\"\<Var\>\"", ",", "tensor"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"inds", "=", 
         RowBox[{"DummyIn", "/@", 
          RowBox[{"SlotsOfTensor", "[", "tensor", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"xTensorQ", "[", "dummyloc", "]"}]}], ",", 
          RowBox[{"DefTensor", "[", 
           RowBox[{
            RowBox[{"dummyloc", "@@", "inds"}], ",", 
            RowBox[{"First", "@", 
             RowBox[{"DependenciesOfTensor", "@", "tensor"}]}]}], "]"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SymmetryGroupOfTensor", "[", "dummyloc", "]"}], "^=", 
         RowBox[{"SymmetryGroupOfTensor", "[", "tensor", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Then", " ", "we", " ", "perturb", " ", "the", " ", "action", " ", 
          "and", " ", "replace", " ", 
          RowBox[{"Perturbation", "[", 
           RowBox[{"Tensor", "[", "..", "]"}], "]"}], " ", "by", " ", "this", 
          " ", "dummy", " ", "tensor"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"pertexpr", "=", 
         RowBox[{"(", 
          RowBox[{"ToCanonical", "@", 
           RowBox[{"ContractMetric", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ExpandPerturbation", "@", 
               RowBox[{"Perturbation", "[", "expr", "]"}]}], "/.", 
              RowBox[{
               RowBox[{"Perturbation", "[", 
                RowBox[{
                 RowBox[{"tens_", "?", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "=!=", "tensor"}], ")"}], "&"}], ")"}]}], 
                 "[", "ar___", "]"}], "]"}], "\[RuleDelayed]", "0"}]}], "/.", 
             
             RowBox[{
              RowBox[{"Perturbation", "[", 
               RowBox[{"tensor", "[", "ind___", "]"}], "]"}], 
              "\[RuleDelayed]", 
              RowBox[{"dummyloc", "[", "ind", "]"}]}]}], "]"}]}], ")"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"With", " ", "this", " ", "simple", " ", "head"}], ",", " ", 
          RowBox[{"VarD", " ", "works", " ", 
           RowBox[{"correctly", ".", " ", "Again"}], " ", "we", " ", "need", 
           " ", "to", " ", "handel", " ", "some", " ", "trivial", " ", 
           "Kronecker"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"res", "=", 
         RowBox[{"ToCanonical", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"SameDummies", "@", 
             RowBox[{"ContractMetric", "@", 
              RowBox[{
               RowBox[{"VarD", "[", 
                RowBox[{
                 RowBox[{"dummyloc", "@@", "inds"}], ",", "covd"}], "]"}], 
               "[", "pertexpr", "]"}]}]}], ")"}], "/.", 
           RowBox[{
            RowBox[{"delta", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"LI", "[", "n_", "]"}]}], ",", 
              RowBox[{"LI", "[", "m_", "]"}]}], "]"}], "\[RuleDelayed]", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{
              RowBox[{"NoScalar", "[", "n", "]"}], ",", 
              RowBox[{"NoScalar", "[", "m", "]"}]}], "]"}]}]}], "]"}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "res"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PerturbAction", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{"tensor_", "[", "inds___", "]"}]}], "]"}], ":=", 
  RowBox[{"PerturbAction", "[", 
   RowBox[{"expr", ",", 
    RowBox[{"tensor", "[", "inds", "]"}], ",", 
    RowBox[{"CovDOfMetric", "@", 
     RowBox[{"First", "@", "$Metrics"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PerturbAction", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{
     RowBox[{"tensor_", "?", "xTensorQ"}], "[", "inds___", "]"}], ",", 
    "covd_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", ",", "dummyloc", ",", "pertexpr"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"$DefInfoQ", "=", "False"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dummyloc", "=", 
         RowBox[{"SymbolJoin", "[", 
          RowBox[{"\"\<Var\>\"", ",", "tensor"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"xTensorQ", "[", "dummyloc", "]"}]}], ",", 
          RowBox[{"DefTensor", "[", 
           RowBox[{
            RowBox[{"dummyloc", "[", "inds", "]"}], ",", 
            RowBox[{"First", "@", 
             RowBox[{"DependenciesOfTensor", "@", "tensor"}]}]}], "]"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SymmetryGroupOfTensor", "[", "dummyloc", "]"}], "^=", 
         RowBox[{"SymmetryGroupOfTensor", "[", "tensor", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Perturbation", " ", "with", " ", "xPert"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"pertexpr", "=", 
         RowBox[{"(", 
          RowBox[{"ToCanonical", "@", 
           RowBox[{"ContractMetric", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ExpandPerturbation", "@", 
               RowBox[{"Perturbation", "[", "expr", "]"}]}], "/.", 
              RowBox[{
               RowBox[{"Perturbation", "[", 
                RowBox[{
                 RowBox[{"tens_", "?", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "=!=", "tensor"}], ")"}], "&"}], ")"}]}], 
                 "[", "ar___", "]"}], "]"}], "\[RuleDelayed]", "0"}]}], "/.", 
             
             RowBox[{
              RowBox[{"Perturbation", "[", 
               RowBox[{"tensor", "[", "ind___", "]"}], "]"}], 
              "\[RuleDelayed]", 
              RowBox[{"dummyloc", "[", "ind", "]"}]}]}], "]"}]}], ")"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "VarD", " ", "and", " ", "removal", " ", "of", " ", 
          "KroneckerDelta"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"res", "=", 
         RowBox[{"ToCanonical", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"SameDummies", "@", 
             RowBox[{"ContractMetric", "@", 
              RowBox[{
               RowBox[{"VarD", "[", 
                RowBox[{
                 RowBox[{"dummyloc", "[", "inds", "]"}], ",", "covd"}], "]"}],
                "[", "pertexpr", "]"}]}]}], ")"}], "/.", 
           RowBox[{
            RowBox[{"delta", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"LI", "[", "n_", "]"}]}], ",", 
              RowBox[{"LI", "[", "m_", "]"}]}], "]"}], "\[RuleDelayed]", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{
              RowBox[{"NoScalar", "[", "n", "]"}], ",", 
              RowBox[{"NoScalar", "[", "m", "]"}]}], "]"}]}]}], "]"}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "res"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{
  3.878607251581006*^9, {3.8786072846997766`*^9, 3.87860730282133*^9}},
 CellLabel->
  "In[264]:=",ExpressionUUID->"8b46d6c8-7840-4e7f-977e-fe87b1f9fcee"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"VarAction", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{
     RowBox[{"g_", "?", "MetricQ"}], "[", 
     RowBox[{"as__", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"UpIndexQ", "[", "#", "]"}], "||", 
          RowBox[{"DownIndexQ", "[", "#", "]"}]}], ")"}], "&"}], ")"}]}], 
     "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "sqrtg", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sqrtg", "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"SignDetOfMetric", "[", "g", "]"}], 
        RowBox[{
         RowBox[{"Determinant", "[", "g", "]"}], "[", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ToCanonical", "[", 
      RowBox[{
       RowBox[{"PerturbAction", "[", 
        RowBox[{"expr", ",", 
         RowBox[{"g", "[", "as", "]"}]}], "]"}], "+", 
       RowBox[{
        RowBox[{"ReplaceDummies", "@", "expr"}], "*", 
        RowBox[{
         RowBox[{"PerturbAction", "[", 
          RowBox[{"sqrtg", ",", 
           RowBox[{"g", "[", "as", "]"}]}], "]"}], "/", "sqrtg"}]}]}], " ", 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VarAction", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{"tensor_", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xTensorQ", "[", "#", "]"}], "&&", 
         RowBox[{"Not", "[", 
          RowBox[{"MetricQ", "[", "#", "]"}], "]"}]}], ")"}], "&"}], ")"}]}], 
    ",", 
    RowBox[{"g_", "?", "MetricQ"}]}], "]"}], ":=", 
  RowBox[{"PerturbAction", "[", 
   RowBox[{"expr", ",", "tensor", ",", 
    RowBox[{"CovDOfMetric", "[", "g", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VarAction", "[", 
     RowBox[{"expr_", ",", 
      RowBox[{"tensor_", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"xTensorQ", "[", "#", "]"}], "&&", 
           RowBox[{"Not", "[", 
            RowBox[{"MetricQ", "[", "#", "]"}], "]"}]}], ")"}], "&"}], 
        ")"}]}]}], "]"}], ":=", 
    RowBox[{"VarAction", "[", 
     RowBox[{"expr", ",", "tensor", ",", 
      RowBox[{"First", "@", "$Metrics"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VarAction", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{
     RowBox[{"tensor_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"xTensorQ", "[", "#", "]"}], "&&", 
          RowBox[{"Not", "[", 
           RowBox[{"MetricQ", "[", "#", "]"}], "]"}]}], ")"}], "&"}], ")"}]}],
      "[", "inds___", "]"}], ",", 
    RowBox[{"g_", "?", "MetricQ"}]}], "]"}], ":=", 
  RowBox[{"PerturbAction", "[", 
   RowBox[{"expr", ",", 
    RowBox[{"tensor", "[", "inds", "]"}], ",", 
    RowBox[{"CovDOfMetric", "[", "g", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VarAction", "[", 
    RowBox[{"expr_", ",", 
     RowBox[{
      RowBox[{"tensor_", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"xTensorQ", "[", "#", "]"}], "&&", 
           RowBox[{"Not", "[", 
            RowBox[{"MetricQ", "[", "#", "]"}], "]"}]}], ")"}], "&"}], 
        ")"}]}], "[", "inds___", "]"}]}], "]"}], ":=", 
   RowBox[{"VarAction", "[", 
    RowBox[{"expr", ",", 
     RowBox[{"tensor", "[", "inds", "]"}], ",", 
     RowBox[{"First", "@", "$Metrics"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8786073150684023`*^9, 3.8786073240003543`*^9}},
 CellLabel->
  "In[268]:=",ExpressionUUID->"2cf87351-7d12-4ae1-978d-3ffb0c2350b0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quiet", "@", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "Print", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DefTensor", "[", 
       RowBox[{
        RowBox[{"\[Phi]", "[", "]"}], ",", "M"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"DefScalarFunction", "[", "V", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"DefTensor", "[", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"-", "a"}], "]"}], ",", "M"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"DefTensor", "[", 
       RowBox[{
        RowBox[{"F", "[", 
         RowBox[{
          RowBox[{"-", "a"}], ",", 
          RowBox[{"-", "b"}]}], "]"}], ",", "M", ",", 
        RowBox[{"Antisymmetric", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "a"}], ",", 
           RowBox[{"-", "b"}]}], "}"}], "]"}]}], "]"}], " ", ";", 
      "\[IndentingNewLine]", 
      RowBox[{"DefMetric", "[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", 
        RowBox[{"g", "[", 
         RowBox[{
          RowBox[{"-", "a"}], ",", 
          RowBox[{"-", "b"}]}], "]"}], ",", "CD", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<;\>\"", ",", "\"\<\[Del]\>\""}], "}"}], ",", 
        RowBox[{"PrintAs", "\[Rule]", "\"\<g\>\""}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"IndexSetDelayed", "[", 
       RowBox[{
        RowBox[{"F", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"CD", "[", "a", "]"}], "[", 
          RowBox[{"A", "[", "b", "]"}], "]"}], "-", 
         RowBox[{
          RowBox[{"CD", "[", "b", "]"}], "[", 
          RowBox[{"A", "[", "a", "]"}], "]"}]}]}], "]"}], ";"}]}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.8786073702218075`*^9, 3.8786073825087967`*^9}, {
   3.8786074213001137`*^9, 3.8786074220649157`*^9}, {3.8786074560381947`*^9, 
   3.8786074566942716`*^9}, {3.878607566432367*^9, 3.8786076819396086`*^9}, {
   3.8786077520509195`*^9, 3.878607789444419*^9}, {3.8786078521387625`*^9, 
   3.8786079141901135`*^9}, {3.878607978410421*^9, 3.878607980494315*^9}, 
   3.878608951054315*^9, 3.8787006701676984`*^9, {3.8806679069421263`*^9, 
   3.8806679174664316`*^9}, {3.8806679716372766`*^9, 
   3.8806679829143305`*^9}, {3.881111975514069*^9, 3.881111978422061*^9}, {
   3.881112096906589*^9, 3.881112099266447*^9}, {3.881297815200663*^9, 
   3.8812978250322614`*^9}},ExpressionUUID->"7645ea55-16ba-42fd-a4d2-\
fcf2ef278639"],

Cell["Scalar field Lagrangian", "Text",
 CellChangeTimes->{{3.8786972230204477`*^9, 
  3.8786972478094826`*^9}},ExpressionUUID->"e995b5c7-1cb8-4346-878c-\
535395f3c334"],

Cell[BoxData[{
 RowBox[{"L", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"1", "/", "2"}], 
    RowBox[{
     RowBox[{"CD", "[", "a", "]"}], "@", 
     RowBox[{"\[Phi]", "[", "]"}]}], 
    RowBox[{
     RowBox[{"CD", "[", 
      RowBox[{"-", "a"}], "]"}], "@", 
     RowBox[{"\[Phi]", "[", "]"}]}]}], "-", 
   RowBox[{"V", "[", 
    RowBox[{"\[Phi]", "[", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"VarAction", "[", 
  RowBox[{"L", ",", 
   RowBox[{"g", "[", 
    RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"VarAction", "[", 
  RowBox[{"L", ",", 
   RowBox[{"\[Phi]", "[", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8786074839521275`*^9, 3.878607484545952*^9}},
 CellLabel->
  "In[274]:=",ExpressionUUID->"eaafecff-ef40-44c8-84ea-751922b8f64a"],

Cell["Maxwell Lagrangian", "Text",
 CellChangeTimes->{{3.87869722891012*^9, 
  3.8786972436495743`*^9}},ExpressionUUID->"fab1753c-3dc1-4a5d-ba70-\
0090261d4052"],

Cell[BoxData[{
 RowBox[{"L", "=", 
  RowBox[{
   RowBox[{"F", "[", 
    RowBox[{"a", ",", "b"}], "]"}], 
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "b"}]}], "]"}], "/", "4"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"VarAction", "[", 
  RowBox[{"L", ",", 
   RowBox[{"g", "[", 
    RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"VarAction", "[", 
  RowBox[{"L", ",", 
   RowBox[{"A", "[", "a", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.878607508725273*^9, 3.878607516667853*^9}},
 CellLabel->
  "In[277]:=",ExpressionUUID->"b043bad2-7b73-439e-a80e-2da6d806625c"],

Cell["Hilbert - Einstein Lagrangian", "Text",
 CellChangeTimes->{{3.8786972504912157`*^9, 
  3.8786972650944176`*^9}},ExpressionUUID->"269af99b-f433-4cba-81b1-\
1e63a607e0dd"],

Cell[BoxData[{
 RowBox[{"L", "=", 
  RowBox[{"RicciScalarCD", "[", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"VarAction", "[", 
  RowBox[{"L", ",", 
   RowBox[{"g", "[", 
    RowBox[{"a", ",", "b"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8786075597564125`*^9, 3.878607560567732*^9}, {
  3.878607944833376*^9, 3.878607967342206*^9}, {3.8786094588859034`*^9, 
  3.878609517824259*^9}, {3.8786095577595606`*^9, 3.8786095805614576`*^9}},
 CellLabel->
  "In[280]:=",ExpressionUUID->"eb80e257-bc30-4627-8b92-5e99fdbe017e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Neat example: ",
 Cell[BoxData[
  FormBox[
   RowBox[{"R", "+", 
    RowBox[{"\[Alpha]", " ", 
     SuperscriptBox["R", "2"]}], "+", 
    RowBox[{"\[Beta]", " ", 
     SubscriptBox["R", "ab"], 
     SuperscriptBox["R", "ab"]}]}], TraditionalForm]],ExpressionUUID->
  "16821c85-9759-4650-9df3-645e502fff13"],
 " gravity"
}], "Subsection",
 CellChangeTimes->{{3.8786948718227243`*^9, 3.878694919069141*^9}, {
  3.880670507349587*^9, 
  3.8806705243476925`*^9}},ExpressionUUID->"fff6dc1d-8a8a-460d-8e7f-\
7a640fe7119f"],

Cell["First some definitions to construct Lagrangian:", "Text",
 CellChangeTimes->{{3.880669312430731*^9, 3.8806693616793137`*^9}, 
   3.8806694109117155`*^9},ExpressionUUID->"ff2b1566-907c-41a9-b914-\
3f45359b5b69"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefTensor", "[", 
   RowBox[{
    RowBox[{"\[Alpha]", "[", "]"}], ",", "M"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefTensor", "[", 
   RowBox[{
    RowBox[{"\[Beta]", "[", "]"}], ",", "M"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"L", "=", 
  RowBox[{
   RowBox[{"RicciScalarCD", "[", "]"}], "+", 
   RowBox[{
    RowBox[{"\[Alpha]", "[", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"RicciScalarCD", "[", "]"}], ")"}], "2"]}], "+", 
   RowBox[{
    RowBox[{"\[Beta]", "[", "]"}], " ", 
    RowBox[{"RicciCD", "[", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "b"}]}], "]"}], 
    RowBox[{"RicciCD", "[", 
     RowBox[{"a", ",", "b"}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdxVsoQwEABuA1Qoq0KJcXM6YpDySKJWfak1oi5UEui62VNoTNikmxrS0i
VqNYLJfJiuROXmxt00irISLalmyJxDpGzr+Hr48plNV10Gk0WhYFr7Gl+fH+
IBEO6Atx+424CLNbNGXY03wvwkRVnxgL6uP2E6gzZUo7tjgVl3ir9O8KT1cs
e3GlmnGNY9/VQ7aXIFE7kGzAY3JyARu6RBbMauNYcYHffIAfv8kTbJMbT3Fa
ieMM7wS6bfhIILjAGl6qBycrn734gc66wceu3hCORH4/Mbf8lcTaGN0PTuQz
U+zUPUt36fjWotM6qA8/OFO4scY1i3P21k24WEEE8ZxE+Ia5D09JTuphHxk9
e7SBgVUhafTwyq4emzImDTi3aXsWf1ny5jEhpJtx64Y7utU3s4qNksAm9qvn
xl3U/Or+CcxzewfPqTsXR1T4HxFqBvY=
  "],
 CellLabel->
  "In[282]:=",ExpressionUUID->"4d2a46da-c17d-4ad2-916d-d9ec2231419c"],

Cell["Then we vary the action with the metric tensor.", "Text",
 CellChangeTimes->{{3.8806693955082245`*^9, 
  3.8806694680512276`*^9}},ExpressionUUID->"f50c67b1-0e16-451c-afc0-\
64dc3f5375b7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"C1Rule", "=", 
   RowBox[{"MakeRule", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"CD", "[", "a", "]"}], "@", 
       RowBox[{"\[Alpha]", "[", "]"}]}], ",", "0"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"C2Rule", "=", 
    RowBox[{"MakeRule", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"CD", "[", "a", "]"}], "@", 
        RowBox[{"\[Beta]", "[", "]"}]}], ",", "0"}], "}"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "To", " ", "assure", " ", "C1", " ", "and", " ", "C2", " ", "are", " ", 
    "coefficients"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"VariedAction", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"VarAction", "[", 
      RowBox[{"L", ",", 
       RowBox[{"g", "[", 
        RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "/.", "C1Rule"}], "/.", 
    "C2Rule"}], "//", "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.8806693345583143`*^9, 3.8806693409897747`*^9}, {
  3.880669382867562*^9, 3.880669385808755*^9}, {3.8806703504672303`*^9, 
  3.8806703520009885`*^9}, {3.8806704567720013`*^9, 3.8806704681721244`*^9}, {
  3.880670561772562*^9, 3.880670566637933*^9}, {3.880670619968096*^9, 
  3.880670621734312*^9}, {3.88067097689741*^9, 3.880670978284437*^9}, {
  3.8806710411484632`*^9, 3.8806710439348392`*^9}, {3.8806710903053846`*^9, 
  3.8806710947766047`*^9}, {3.8812976102881937`*^9, 3.8812976633960037`*^9}},
 CellLabel->
  "In[286]:=",ExpressionUUID->"f72d28ba-1aea-4cdc-8e37-c3b1c2de7066"],

Cell["\<\
It is impossible to evaluate the above result using CTensor, so we make a \
temporary file to store the result.\
\>", "Text",
 CellChangeTimes->{{3.8812987906029773`*^9, 
  3.8812988780358887`*^9}},ExpressionUUID->"f71e970f-f045-4f0e-a3de-\
82a401d42b33"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "<>", 
     "\"\<VariedAction.png\>\""}], ",", 
    RowBox[{"Rasterize", "[", 
     RowBox[{
      RowBox[{"NotebookRead", "[", 
       RowBox[{"PreviousCell", "[", "]"}], "]"}], ",", 
      RowBox[{"ImageResolution", "\[Rule]", "100"}], ",", 
      RowBox[{"ImageSize", "->", "Large"}]}], "]"}]}], "]"}], ";"}]], "Input",\

 CellChangeTimes->{{3.8812957086578093`*^9, 3.8812957108916044`*^9}, {
   3.881295752093964*^9, 3.881295840023669*^9}, {3.881295957651171*^9, 
   3.8812960023550835`*^9}, {3.8812960373959937`*^9, 
   3.8812960419088163`*^9}, {3.881296269712614*^9, 3.881296304076522*^9}, {
   3.88129640435429*^9, 3.8812964074332247`*^9}, 3.881296644251985*^9, 
   3.8812970521605434`*^9, {3.8812974298277063`*^9, 3.8812974418333693`*^9}, {
   3.881297527148864*^9, 3.881297536186742*^9}, 3.8812976878663173`*^9, {
   3.88129779087035*^9, 3.8812977961518564`*^9}},
 CellLabel->
  "In[289]:=",ExpressionUUID->"5a7113c3-7390-4000-9072-ac50f3ce0056"],

Cell["\<\
To find Friedmann equations, we have to redefine Chart, metric, etc. again.\
\>", "Text",
 CellChangeTimes->{{3.8806697737667446`*^9, 3.880669790767927*^9}, {
  3.8806706754111753`*^9, 3.8806706863981247`*^9}, {3.880674367100094*^9, 
  3.8806743685808716`*^9}, {3.881298753022427*^9, 3.881298785571666*^9}, {
  3.881298894707137*^9, 3.8812989564452095`*^9}, {3.8813011877999315`*^9, 
  3.881301188107517*^9}},ExpressionUUID->"30b9366d-cdba-4546-a68f-\
c5669f9b805f"],

Cell[BoxData[{
 RowBox[{"removeAll", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"removeAll", ":=", 
   RowBox[{"Remove", "[", 
    RowBox[{"Evaluate", "[", 
     RowBox[{"$Context", "<>", "\"\<*\>\""}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{"Quiet", "@", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "Print", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"<<", "xAct`xCoba`"}], 
      RowBox[{"<<", "xAct`xTras`"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DefManifold", "[", 
      RowBox[{"M", ",", "4", ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DefChart", "[", 
      RowBox[{"Cartesian", ",", "M", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "2", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"t", "[", "]"}], ",", 
         RowBox[{"x", "[", "]"}], ",", 
         RowBox[{"y", "[", "]"}], ",", 
         RowBox[{"z", "[", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DefScalarFunction", "/@", 
      RowBox[{"{", 
       RowBox[{"R", ",", "H"}], "}"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"DefScalarFunction", "/@", 
      RowBox[{"{", 
       RowBox[{"\[Alpha]", ",", "\[Beta]"}], "}"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"R", "'"}], "[", "t_", "]"}], ":=", 
      RowBox[{
       RowBox[{"H", "[", "t", "]"}], 
       RowBox[{"R", "[", "t", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"R", "''"}], "[", "t_", "]"}], ":=", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"H", "[", "t", "]"}], 
         RowBox[{"R", "[", "t", "]"}]}], ",", "t"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"metricMatrix", "=", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{
            RowBox[{"R", "[", 
             RowBox[{"t", "[", "]"}], "]"}], "^", "2"}]}], ",", "0", ",", "0",
           ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"R", "[", 
            RowBox[{"t", "[", "]"}], "]"}], "^", "2"}], ",", "0", ",", "0"}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{
           RowBox[{"R", "[", 
            RowBox[{"t", "[", "]"}], "]"}], "^", "2"}], ",", "0"}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", 
          RowBox[{
           RowBox[{"R", "[", 
            RowBox[{"t", "[", "]"}], "]"}], "^", "2"}]}], "}"}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{"CTensor", "[", 
       RowBox[{"metricMatrix", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "Cartesian"}], ",", 
          RowBox[{"-", "Cartesian"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SetCMetric", "[", 
      RowBox[{"g", ",", "Cartesian", ",", 
       RowBox[{"SignatureOfMetric", "->", 
        RowBox[{"{", 
         RowBox[{"3", ",", "1", ",", "0"}], "}"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"covd", "=", 
      RowBox[{"LC", "[", "g", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"MetricCompute", "[", 
      RowBox[{"g", ",", "Cartesian", ",", "All"}], "]"}], ";"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8811396014654922`*^9, 3.88113960843945*^9}, {
   3.881139653201436*^9, 3.8811396533934774`*^9}, 3.8811397459979153`*^9, 
   3.88129527163378*^9, {3.881295351428557*^9, 3.8812953927805605`*^9}, {
   3.88129564073559*^9, 3.8812956604562564`*^9}, {3.881297699572286*^9, 
   3.8812977264245872`*^9}, {3.881297908850891*^9, 3.88129792599993*^9}, 
   3.8812987485420337`*^9, {3.8812989664108915`*^9, 3.881298999595171*^9}, {
   3.8812994129556904`*^9, 3.881299414945657*^9}, {3.8812996627427998`*^9, 
   3.881299685667153*^9}, {3.8813009027670083`*^9, 3.881300939508667*^9}},
 CellLabel->
  "In[536]:=",ExpressionUUID->"fc49d9ab-5716-4f53-acf2-572b763e3e5a"],

Cell[BoxData[
 RowBox[{"Import", "[", 
  RowBox[{
   RowBox[{"ToString", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "<>", 
   "\"\<VariedAction.png\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.8812977431017895`*^9, 3.8812977651058583`*^9}},
 CellLabel->
  "In[539]:=",ExpressionUUID->"2b43487f-4d06-4592-9d6f-6e1d916b7fe2"],

Cell["\<\
We need to convert the above output to the corresponding CTensor form \
manually... (a bit tedious but no other way!)\
\>", "Text",
 CellChangeTimes->{{3.88129903184896*^9, 3.8812991327178354`*^9}, {
  3.88130155191313*^9, 
  3.881301553544468*^9}},ExpressionUUID->"ce58681e-2af2-4af7-9f6c-\
25a690df703e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MyArrayComponents", "[", "expr_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"expr", "//", 
        RowBox[{"ToBasis", "[", "Cartesian", "]"}]}], "//", 
       "ComponentArray"}], "//", "ToValues"}], "//", "ToValues"}], "//", 
    "ToValues"}], "//", "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Eq", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Ricci", "[", "covd", "]"}], "[", 
       RowBox[{
        RowBox[{"-", "a"}], ",", "b"}], "]"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"\[Alpha]", "[", "]"}], 
         RowBox[{
          RowBox[{"RicciScalar", "[", "covd", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}]}], "-", 
     RowBox[{"2", 
      RowBox[{"\[Alpha]", "[", "]"}], 
      RowBox[{
       RowBox[{"covd", "[", "b", "]"}], "[", 
       RowBox[{
        RowBox[{"covd", "[", 
         RowBox[{"-", "a"}], "]"}], "[", 
        RowBox[{
         RowBox[{"RicciScalar", "[", "covd", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"\[Beta]", "[", "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", 
         RowBox[{
          RowBox[{"Ricci", "[", "covd", "]"}], "[", 
          RowBox[{
           RowBox[{"-", "a"}], ",", "c"}], "]"}], 
         RowBox[{
          RowBox[{"Ricci", "[", "covd", "]"}], "[", 
          RowBox[{"b", ",", 
           RowBox[{"-", "c"}]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"covd", "[", 
          RowBox[{"-", "c"}], "]"}], "[", 
         RowBox[{
          RowBox[{"covd", "[", 
           RowBox[{"-", "a"}], "]"}], "[", 
          RowBox[{
           RowBox[{"Ricci", "[", "covd", "]"}], "[", 
           RowBox[{"b", ",", "c"}], "]"}], "]"}], "]"}], "-", 
        RowBox[{
         RowBox[{"covd", "[", 
          RowBox[{"-", "c"}], "]"}], "[", 
         RowBox[{
          RowBox[{"covd", "[", "b", "]"}], "[", 
          RowBox[{
           RowBox[{"Ricci", "[", "covd", "]"}], "[", 
           RowBox[{
            RowBox[{"-", "a"}], ",", "c"}], "]"}], "]"}], "]"}], "+", 
        RowBox[{
         RowBox[{"covd", "[", 
          RowBox[{"-", "c"}], "]"}], "[", 
         RowBox[{
          RowBox[{"covd", "[", "c", "]"}], "[", 
          RowBox[{
           RowBox[{"Ricci", "[", "covd", "]"}], "[", 
           RowBox[{
            RowBox[{"-", "a"}], ",", "b"}], "]"}], "]"}], "]"}]}], ")"}]}], 
     "-", 
     RowBox[{
      RowBox[{"1", "/", "2"}], " ", 
      RowBox[{"g", "[", 
       RowBox[{
        RowBox[{"-", "a"}], ",", "b"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"RicciScalar", "[", "covd", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", 
        RowBox[{
         RowBox[{"\[Alpha]", "[", "]"}], 
         RowBox[{
          RowBox[{
           RowBox[{"RicciScalar", "[", "covd", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "^", "2"}]}], " ", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Ricci", "[", "covd", "]"}], "[", 
          RowBox[{
           RowBox[{"-", "c"}], ",", 
           RowBox[{"-", "d"}]}], "]"}], 
         RowBox[{
          RowBox[{"Ricci", "[", "covd", "]"}], "[", 
          RowBox[{"c", ",", "d"}], "]"}]}], "-", 
        RowBox[{"4", 
         RowBox[{"\[Alpha]", "[", "]"}], 
         RowBox[{
          RowBox[{"covd", "[", 
           RowBox[{"-", "c"}], "]"}], "[", 
          RowBox[{
           RowBox[{"covd", "[", "c", "]"}], "[", 
           RowBox[{
            RowBox[{"RicciScalar", "[", "covd", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "-", 
        RowBox[{"2", 
         RowBox[{"\[Beta]", "[", "]"}], 
         RowBox[{
          RowBox[{"covd", "[", 
           RowBox[{"-", "d"}], "]"}], "[", 
          RowBox[{
           RowBox[{"covd", "[", 
            RowBox[{"-", "c"}], "]"}], "[", 
           RowBox[{
            RowBox[{"Ricci", "[", "covd", "]"}], "[", 
            RowBox[{"c", ",", "d"}], "]"}], "]"}], "]"}]}]}], ")"}]}]}], "//",
     "MyArrayComponents"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8811153600641575`*^9, 3.8811153698739533`*^9}, {
   3.881129595576744*^9, 3.881129600366522*^9}, {3.881132504765276*^9, 
   3.8811325057181625`*^9}, 3.881295367207341*^9, {3.8812954122778444`*^9, 
   3.881295435277769*^9}, {3.881297889924096*^9, 3.88129789243579*^9}, {
   3.8812979349410677`*^9, 3.88129797396885*^9}, {3.8812980048628416`*^9, 
   3.8812984056436825`*^9}, 3.8812985620756493`*^9, 3.881299695107904*^9, 
   3.881300221931345*^9, 3.881300950295702*^9},
 CellLabel->
  "In[540]:=",ExpressionUUID->"4c13fb7c-923e-4795-9faf-535ab1ea7298"],

Cell[TextData[{
 "Let' s now define the energy-momentum tensor. We first define an observer' \
s 4-velocity vector ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["u", "\[Mu]"], TraditionalForm]],ExpressionUUID->
  "1b6c42a9-d4f6-43be-98dd-63d71799595b"],
 "."
}], "Text",
 CellChangeTimes->{{3.8806695332339525`*^9, 3.8806695755019183`*^9}, {
   3.8806696139900775`*^9, 3.880669629347963*^9}, 3.8806702956617193`*^9, {
   3.8806706980255694`*^9, 3.8806706984923863`*^9}, {3.88111062710362*^9, 
   3.881110656305095*^9}},ExpressionUUID->"0166fc55-ffff-4211-84eb-\
c669a47e0f02"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"DefTensor", "[", 
   RowBox[{
    RowBox[{"u", "[", "a", "]"}], ",", "M"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uComponents", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"1", "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"-", 
           RowBox[{"g", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "Cartesian"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "Cartesian"}]}], "}"}]}], "]"}]}], "]"}]}], "//", 
        "ToValues"}], ",", 
       RowBox[{"Assumptions", "\[Rule]", 
        RowBox[{
         RowBox[{"R", "[", 
          RowBox[{"t", "[", "]"}], "]"}], ">", "0"}]}]}], "]"}], ",", "0", 
     ",", "0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"CTensor", "[", 
    RowBox[{"uComponents", ",", 
     RowBox[{"{", "Cartesian", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8806690864009438`*^9, 3.880669109644681*^9}, 
   3.880670588819168*^9, {3.8806707227691216`*^9, 3.8806707602532873`*^9}, {
   3.8811108730254855`*^9, 3.881110876190941*^9}, {3.8811109091126213`*^9, 
   3.8811109162667665`*^9}, {3.8812984714928584`*^9, 3.881298487217677*^9}, {
   3.8812985240345907`*^9, 3.8812985246627884`*^9}, {3.881299163280654*^9, 
   3.881299165838262*^9}, {3.8812992347157326`*^9, 3.881299243760933*^9}, {
   3.881299311808297*^9, 3.881299321265273*^9}, {3.8812995210955734`*^9, 
   3.8812995370223227`*^9}, {3.8812995712424617`*^9, 3.881299614558976*^9}, {
   3.8812997059030733`*^9, 3.881299730908141*^9}, {3.8812999009323397`*^9, 
   3.881299923909778*^9}, {3.8813009544009724`*^9, 3.8813009594222407`*^9}},
 CellLabel->
  "In[542]:=",ExpressionUUID->"65ae8749-1751-49de-80d1-dac29832b26f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** \"\>", "\[InvisibleSpace]", "DefTensor", 
   "\[InvisibleSpace]", "\<\": Defining \"\>", 
   "\[InvisibleSpace]", "\<\"tensor \"\>", "\[InvisibleSpace]", 
   RowBox[{"u", "[", "a", "]"}], "\[InvisibleSpace]", "\<\". \"\>", 
   "\[InvisibleSpace]", "\<\"\"\>"}],
  SequenceForm["** ", xAct`xTensor`DefTensor, ": Defining ", "tensor ", 
   $CellContext`u[$CellContext`a], ". ", ""],
  Editable->False]], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.8812995910307274`*^9, 3.8812996152428875`*^9}, {
   3.881299717820722*^9, 3.8812997334400625`*^9}, {3.8812999301933675`*^9, 
   3.8812999514864883`*^9}, 3.881300961350783*^9, {3.881301295460136*^9, 
   3.881301315579938*^9}},
 CellLabel->
  "\:d3c9\:ac00 \
\:c911In[542]:=",ExpressionUUID->"96bfa9b9-2240-42ef-b46f-b2163c55dc6c"]
}, Open  ]],

Cell["and then components of the energy-momentum tensor.", "Text",
 CellChangeTimes->{{3.8806695964444914`*^9, 3.8806696252385445`*^9}, {
  3.8813012986633673`*^9, 
  3.8813012996051054`*^9}},ExpressionUUID->"9a342477-903f-4bf2-a143-\
8c42c679a8af"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DefTensor", "[", 
   RowBox[{
    RowBox[{"T", "[", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "b"}]}], "]"}], ",", "M", ",", 
    RowBox[{"Symmetric", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "a"}], ",", 
       RowBox[{"-", "b"}]}], "}"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefScalarFunction", "[", "P", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefScalarFunction", "[", "\[Rho]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IndexSet", "[", 
   RowBox[{
    RowBox[{"T", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Rho]", "[", 
       RowBox[{"t", "[", "]"}], "]"}], 
      RowBox[{"u", "[", "a", "]"}], 
      RowBox[{"u", "[", "b", "]"}]}], "+", 
     RowBox[{
      RowBox[{"P", "[", 
       RowBox[{"t", "[", "]"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"a", ",", "b"}], "]"}], "+", 
        RowBox[{
         RowBox[{"u", "[", "a", "]"}], 
         RowBox[{"u", "[", "b", "]"}]}]}], ")"}]}]}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.880669182429945*^9, 3.8806692133801355`*^9}, 
   3.8806696526970916`*^9, 3.880670639543316*^9, {3.8806707680937505`*^9, 
   3.8806707961117544`*^9}, {3.8806708473604903`*^9, 3.880670847622719*^9}, {
   3.881300004153184*^9, 3.8813000062367806`*^9}, {3.881301287778655*^9, 
   3.881301289605694*^9}},
 CellLabel->
  "In[545]:=",ExpressionUUID->"d41f20d4-28fa-49aa-91ba-d83e2f0038fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EMTensor", "=", 
   RowBox[{
    RowBox[{"T", "[", 
     RowBox[{
      RowBox[{"-", "a"}], ",", "b"}], "]"}], "//", "MyArrayComponents"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.8811109996437616`*^9, {3.88130001982963*^9, 3.8813000221108346`*^9}, {
   3.8813000525071917`*^9, 3.8813000599162884`*^9}, 3.8813002334901*^9},
 CellLabel->
  "In[549]:=",ExpressionUUID->"7540b839-a6a8-40af-9885-86c9bc145af8"],

Cell["Now let\[CloseCurlyQuote]s find Friedmann equation for this theory!", \
"Text",
 CellChangeTimes->{{3.880669670013824*^9, 
  3.8806696956410265`*^9}},ExpressionUUID->"5e37afad-df62-4693-9319-\
c2f38cd8ef11"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DefConstantSymbol", "[", "\[Kappa]", "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"8", "\[Pi]G"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EinsteinEq", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Eq", "[", 
    RowBox[{"[", 
     RowBox[{"a", ",", "b"}], "]"}], "]"}], "==", 
   RowBox[{"\[Kappa]", " ", 
    RowBox[{"EMTensor", "[", 
     RowBox[{"[", 
      RowBox[{"a", ",", "b"}], "]"}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.8806697096371374`*^9, 3.8806697104056187`*^9}, {
   3.880670803977478*^9, 3.8806708120972424`*^9}, {3.8806714903629837`*^9, 
   3.8806714918123894`*^9}, 3.880671649444683*^9, {3.880672045188217*^9, 
   3.8806720474194236`*^9}, 3.8811103473759966`*^9, {3.881300044151799*^9, 
   3.881300074261111*^9}, {3.8813001350619555`*^9, 3.8813001651198893`*^9}},
 CellLabel->
  "In[550]:=",ExpressionUUID->"7338c032-f6a4-471b-98e7-adaa3d5e9167"],

Cell[TextData[{
 "temporal and spatial terms. Note that here we did not use Bianchi identity \
to simplify equations so there appears higher derivative terms, i.e., ",
 Cell[BoxData[
  RowBox[{
   SuperscriptBox[
    InterpretationBox[
     StyleBox["H",
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`H,
     Editable->False], 
    TagBox[
     RowBox[{"(", "3", ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   InterpretationBox[
    StyleBox["t",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`t[],
    Editable->False], "]"}]], "Output",
  CellChangeTimes->{
   3.881300178698832*^9, 3.8813002455838904`*^9, 3.8813005627761793`*^9, {
    3.881300798508405*^9, 3.8813008098022346`*^9}, {3.8813009753424234`*^9, 
    3.881301004364068*^9}},ExpressionUUID->
  "9b1162c4-7eb2-443e-b2e9-ef6ed6275bb8"],
 "."
}], "Text",
 CellChangeTimes->{{3.8806700980785027`*^9, 3.8806701105966234`*^9}, {
  3.881301196450795*^9, 
  3.881301250963951*^9}},ExpressionUUID->"a20b7ec5-636a-410f-b357-\
b766cbb4f8d9"],

Cell[BoxData[{
 RowBox[{"G00Eq", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"EinsteinEq", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"H", "[", 
       RowBox[{"t", "[", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"H", "'"}], "[", 
       RowBox[{"t", "[", "]"}], "]"}]}], "}"}], ",", "Simplify"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"GrrEq", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"EinsteinEq", "[", 
     RowBox[{"2", ",", "2"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"H", "[", 
       RowBox[{"t", "[", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"H", "'"}], "[", 
       RowBox[{"t", "[", "]"}], "]"}]}], "}"}], ",", "Simplify"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8806697298343315`*^9, 3.8806697317734184`*^9}, {
  3.8806699139724054`*^9, 3.88066993420621*^9}, {3.880670118096546*^9, 
  3.880670119176628*^9}, {3.8813000850897865`*^9, 3.881300132070255*^9}, {
  3.8813004572984285`*^9, 3.881300459985818*^9}, {3.8813004978174295`*^9, 
  3.8813005581017756`*^9}, {3.8813007923464937`*^9, 3.8813008087603292`*^9}, {
  3.881300984574822*^9, 3.8813010021769857`*^9}},
 CellLabel->
  "In[552]:=",ExpressionUUID->"fbcaab1d-2134-4497-a331-2a85ce83c3df"],

Cell[TextData[{
 "A specific form to represent the equation on ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["H", "\[Prime]"], TraditionalForm]],ExpressionUUID->
  "ee49ea5f-f1b3-408d-9981-cb26d3efa78d"],
 ":"
}], "Text",
 CellChangeTimes->{{3.8806701279012527`*^9, 3.88067018694355*^9}, {
  3.881300645231675*^9, 3.8813006452326756`*^9}, {3.8813011768185825`*^9, 
  3.8813011798549304`*^9}},ExpressionUUID->"14eb9508-1da7-413e-ba8c-\
9bc9fe0c4999"],

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"3", " ", "GrrEq"}], "-", "G00Eq"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"H", "[", 
      RowBox[{"t", "[", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"H", "'"}], "[", 
      RowBox[{"t", "[", "]"}], "]"}]}], "}"}], ",", "Simplify"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.881300621660208*^9, 3.8813006319668407`*^9}, 
   3.8813008192903943`*^9, 3.881301265240791*^9},
 CellLabel->
  "In[554]:=",ExpressionUUID->"6c16d814-a78e-4016-88a3-3e2a60c675c1"],

Cell["For matter conservation equation:", "Text",
 CellChangeTimes->{{3.880670010734721*^9, 
  3.880670019762515*^9}},ExpressionUUID->"1d5a3b62-4b90-496f-a584-\
503654007c5c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Cons", "[", "b_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "a", "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"covd", "[", 
       RowBox[{"-", "a"}], "]"}], "@", 
      RowBox[{"T", "[", 
       RowBox[{"a", ",", "b"}], "]"}]}], "==", "0"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cons", "[", "b", "]"}], "//", "MyArrayComponents"}], ")"}], "[", 
  
  RowBox[{"[", "1", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8806700771793275`*^9, 3.8806700775317893`*^9}, {
   3.8806708174826555`*^9, 3.880670830088891*^9}, 3.8813002786914587`*^9, {
   3.8813003431313095`*^9, 3.8813003438488197`*^9}, {3.8813003914068556`*^9, 
   3.88130039530564*^9}, {3.8813017520025187`*^9, 3.8813017522635517`*^9}},
 CellLabel->
  "In[560]:=",ExpressionUUID->"5ff9b9d5-2e01-42dd-94a7-6cd7b0489579"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowToolbars->"MultipurposeBar",
WindowSize->{1152., 585.6},
WindowMargins->{{
  Automatic, -5.399999999999864}, {-5.399999999999977, Automatic}},
DockedCells->FEPrivate`FrontEndResource[
 "NotebookTemplatingExpressions", "AuthoringDockedCell"],
TaggingRules->{
 "NotebookTemplateVersion" -> 2., "NotebookTemplate" -> True, 
  "GeneratedNotebookOptions" -> {}, "TryRealOnly" -> False},
CellContext->Notebook,
Magnification:>1.2 Inherited,
FrontEndVersion->"13.2 \:c758 Microsoft Windows (64-bit) (November 18, \
2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"92c953ee-e5f9-49a2-9d3b-faf8cf43beb8"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 166, 3, 83, "Chapter",ExpressionUUID->"460c2ee8-7b59-4e7f-8f8d-e2f9eb42901b"],
Cell[749, 27, 221, 3, 63, "Subtitle",ExpressionUUID->"ffc75fdf-1f7c-4162-b2f0-daa80453e42b"],
Cell[CellGroupData[{
Cell[995, 34, 211, 4, 81, "Section",ExpressionUUID->"2efcd2c8-95de-449a-aff3-f662ae8bf524"],
Cell[1209, 40, 650, 11, 94, "Text",ExpressionUUID->"bd492a49-18bf-4c21-8cf7-8dfe74ff4efe"],
Cell[CellGroupData[{
Cell[1884, 55, 162, 3, 64, "Subsection",ExpressionUUID->"692e99ae-2864-4465-ab27-3f7972ebd803"],
Cell[2049, 60, 2368, 56, 339, "Input",ExpressionUUID->"e350c9a5-dc0b-4645-ba7e-64819a6d8ddd"],
Cell[4420, 118, 258, 6, 41, "Text",ExpressionUUID->"87c57fea-7937-4eed-a89e-be241fdb3c59"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4715, 129, 175, 3, 64, "Subsection",ExpressionUUID->"98ce497b-12c7-4fe0-8610-f245765d8092"],
Cell[4893, 134, 271, 6, 41, "Text",ExpressionUUID->"b9bb3555-fa34-4284-b97a-59f93ad0a63e"],
Cell[5167, 142, 441, 11, 33, "Input",ExpressionUUID->"e6f6ad84-b6bb-4a5e-9fae-22212ed29ecc"],
Cell[5611, 155, 1058, 31, 120, "Input",ExpressionUUID->"be0753d3-fe97-4118-9209-8737914c791f"],
Cell[6672, 188, 459, 11, 57, "Input",ExpressionUUID->"ad07d713-e710-467d-8439-09d85acb5856"],
Cell[7134, 201, 504, 13, 57, "Input",ExpressionUUID->"a979736e-9f16-4f65-b62a-30e4fbd0f8f7"],
Cell[7641, 216, 267, 4, 41, "Text",ExpressionUUID->"f2695a11-485f-409a-9aa8-d175c24f907e"],
Cell[7911, 222, 619, 19, 77, "Input",ExpressionUUID->"1892c5fb-78b5-4106-a24b-e6d25f65caa2"],
Cell[8533, 243, 354, 9, 33, "Input",ExpressionUUID->"796a44bd-30ea-48df-9b09-2a2c7b51f80e"],
Cell[8890, 254, 621, 19, 77, "Input",ExpressionUUID->"003b8da8-8cbd-4612-bf95-4305ab1db83c"],
Cell[9514, 275, 277, 8, 33, "Input",ExpressionUUID->"ebbba7ef-1470-4c8d-82bf-c00da115f3ef"],
Cell[9794, 285, 463, 9, 41, "Text",ExpressionUUID->"603327c6-453e-462a-a1d4-029616f380ec"],
Cell[10260, 296, 414, 12, 52, "Input",ExpressionUUID->"619557a4-d2d2-4963-b8e4-0b99eef281e5"],
Cell[10677, 310, 383, 10, 33, "Input",ExpressionUUID->"7ee81f5e-25c1-470d-9c19-0b4c51de1c75"],
Cell[11063, 322, 637, 20, 52, "Input",ExpressionUUID->"ac1d07a0-0186-4ce7-99e5-dbea357d21b9"],
Cell[11703, 344, 612, 20, 33, "Input",ExpressionUUID->"c81ed5c1-6ca4-4353-acca-ecbc5cc0c534"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12352, 369, 171, 3, 64, "Subsection",ExpressionUUID->"d8436233-bb2f-443d-810b-71311ff45043"],
Cell[12526, 374, 320, 7, 41, "Text",ExpressionUUID->"81802b4d-1b89-439b-be0c-d282576e4946"],
Cell[12849, 383, 1477, 36, 162, "Input",ExpressionUUID->"8b5a8cb2-fdfa-4edc-af18-575e29e05455"],
Cell[14329, 421, 223, 5, 41, "Text",ExpressionUUID->"18591647-7e18-408a-aacf-f94bddded94b"],
Cell[14555, 428, 1702, 43, 211, "Input",ExpressionUUID->"5df5c7f2-0ecb-4bbb-b1e9-eb9283cd894b"],
Cell[16260, 473, 485, 13, 34, "Input",ExpressionUUID->"88e33281-9f83-4736-a0a3-7df429f8d772"],
Cell[16748, 488, 609, 19, 34, "Input",ExpressionUUID->"717af38a-84a9-4a6e-b2eb-ff43f570c054"],
Cell[17360, 509, 210, 4, 52, "Input",ExpressionUUID->"432c95fa-b161-4975-8cee-e42468c29b0a"],
Cell[17573, 515, 222, 4, 41, "Text",ExpressionUUID->"bfa46b17-e47d-4c62-b9b4-f5314e5ab4f9"],
Cell[17798, 521, 627, 18, 34, "Input",ExpressionUUID->"52b05ddd-13d0-48de-8a85-750ad8baa3d3"],
Cell[18428, 541, 550, 17, 34, "Input",ExpressionUUID->"721191ac-7082-458e-9f73-2f0166af3c09"],
Cell[18981, 560, 198, 6, 33, "Input",ExpressionUUID->"b6dfa158-bdde-462a-ba09-ea44fe0f1146"],
Cell[19182, 568, 250, 4, 41, "Text",ExpressionUUID->"bb9bf555-3b7c-44a3-bd7b-d40f2582ca97"],
Cell[19435, 574, 264, 6, 33, "Input",ExpressionUUID->"2d24c5f6-b84a-4e8c-93a5-023b227e11f6"],
Cell[19702, 582, 221, 3, 41, "Text",ExpressionUUID->"f0f3cb9a-465f-4e9e-9031-5c1e60d24a29"],
Cell[19926, 587, 307, 8, 33, "Input",ExpressionUUID->"3eda24ef-f83a-4310-9ca5-505d6f47d222"],
Cell[20236, 597, 375, 10, 34, "Input",ExpressionUUID->"416868de-42bc-4030-ac2a-f3ebfbcffab8"],
Cell[20614, 609, 413, 11, 34, "Input",ExpressionUUID->"806e5f3e-88cd-4dba-aabc-3533406ce4e1"],
Cell[21030, 622, 1011, 26, 103, "Input",ExpressionUUID->"76ad6591-62eb-4ee0-9bc5-669a7884da17"],
Cell[22044, 650, 809, 16, 174, "Text",ExpressionUUID->"868f9c9c-efb7-4c98-825f-1884195ec551"],
Cell[22856, 668, 733, 18, 94, "Input",ExpressionUUID->"602008dd-4e13-4376-a4df-e88c1998c513"],
Cell[23592, 688, 311, 8, 34, "Input",ExpressionUUID->"d08541db-a7db-487d-97ef-04780de81b30"],
Cell[23906, 698, 343, 7, 41, "Text",ExpressionUUID->"5c44f300-3182-4289-afb1-7a1f551c026d"],
Cell[24252, 707, 283, 8, 34, "Input",ExpressionUUID->"cc3ac4f4-0bab-408f-95e5-3b15a7fb5ff2"],
Cell[24538, 717, 265, 7, 34, "Input",ExpressionUUID->"8c477ad5-6332-4177-9122-ea5b146fe523"],
Cell[24806, 726, 1280, 32, 211, "Input",ExpressionUUID->"1f8dba7c-ff86-4c6e-916b-c7e20157a36a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26123, 763, 189, 3, 64, "Subsection",ExpressionUUID->"31a7b9a7-20eb-41a7-86f9-c35999236126"],
Cell[26315, 768, 299, 4, 41, "Text",ExpressionUUID->"62ac10f5-1a7d-4157-8677-9d2476b0acf9"],
Cell[26617, 774, 1125, 25, 75, "Input",ExpressionUUID->"22d32f46-60c8-4ad8-8ee9-e45b24ba02d6"],
Cell[27745, 801, 287, 6, 52, "Input",ExpressionUUID->"f2a3d2d9-cb52-488a-a755-570ebaad6ca3"],
Cell[28035, 809, 490, 13, 34, "Input",ExpressionUUID->"f028dfc8-5db9-4ad2-bd61-d8bca86e904d"],
Cell[28528, 824, 535, 10, 94, "Text",ExpressionUUID->"1417ff20-77be-42ee-ba7d-b037be7617bd"],
Cell[29066, 836, 1373, 44, 57, "Input",ExpressionUUID->"a9bd6be1-ef36-48f8-9478-b30238c00a3e"],
Cell[30442, 882, 434, 9, 34, "Input",ExpressionUUID->"8340b430-3e8d-4f37-bfe3-a29d7b7fd57c"],
Cell[30879, 893, 303, 7, 41, "Text",ExpressionUUID->"c248ae9d-fa32-499c-8427-510ce20ae94f"],
Cell[31185, 902, 579, 10, 34, "Input",ExpressionUUID->"5981030a-3499-4dce-a544-be5251d4b457"],
Cell[31767, 914, 189, 3, 41, "Text",ExpressionUUID->"e1601355-8b35-40db-ab4e-e1c04728c264"],
Cell[31959, 919, 670, 16, 57, "Input",ExpressionUUID->"999e8a58-31d8-4b2a-a0ca-5b1293ae3444"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32666, 940, 169, 3, 64, "Subsection",ExpressionUUID->"f685c3cd-e0a4-403b-8c2e-dd632e942ad4"],
Cell[32838, 945, 247, 4, 41, "Text",ExpressionUUID->"9c6344c7-9012-40fa-b03a-266e8521749e"],
Cell[33088, 951, 1453, 39, 237, "Input",ExpressionUUID->"268d8c4a-b4e4-476e-81cd-982360c9da53"],
Cell[34544, 992, 695, 13, 33, "Input",ExpressionUUID->"da7e91ea-2994-4b8a-ad19-a771fafdd04f"],
Cell[35242, 1007, 366, 9, 34, "Input",ExpressionUUID->"05ca15c3-aa2a-4f9a-99dc-de79b591ff97"],
Cell[35611, 1018, 286, 4, 41, "Text",ExpressionUUID->"5a0eedfd-aeff-428b-995b-bb5167dfefcb"],
Cell[35900, 1024, 415, 8, 57, "Input",ExpressionUUID->"c44fa670-71d0-4073-94c1-650a05689627"],
Cell[36318, 1034, 485, 9, 41, "Text",ExpressionUUID->"1866d622-51d6-487e-9bb3-4a2c5f1f5e2a"],
Cell[36806, 1045, 763, 19, 57, "Input",ExpressionUUID->"97470ce9-5060-4bd6-a1e3-eb7936baa409"],
Cell[37572, 1066, 8009, 178, 688, "Input",ExpressionUUID->"dbefbb3d-a394-4db3-98e2-4f09e2c5be5c"],
Cell[45584, 1246, 454, 10, 33, "Input",ExpressionUUID->"1868aa5e-fbc6-4957-b22d-e1c1fa0b681a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46075, 1261, 168, 3, 64, "Subsection",ExpressionUUID->"0bb57c88-8a51-4363-b96e-0bc62e59f364"],
Cell[46246, 1266, 307, 7, 41, "Text",ExpressionUUID->"39b24fa2-7616-4650-8cdd-bc80f89280cb"],
Cell[46556, 1275, 437, 11, 33, "Input",ExpressionUUID->"a99c89d5-5b2f-4edc-94e6-81ea3e28f416"],
Cell[46996, 1288, 3741, 108, 482, "Input",ExpressionUUID->"034f8dbb-7b86-4ef7-98b9-7c6511b8abcf"],
Cell[50740, 1398, 238, 6, 41, "Text",ExpressionUUID->"708adb15-6acb-422a-9b59-fa583f6c0de7"],
Cell[50981, 1406, 458, 11, 97, "Input",ExpressionUUID->"92fcacbc-574f-4d74-9711-9577c33fba7e"],
Cell[51442, 1419, 264, 6, 41, "Text",ExpressionUUID->"ff609591-f9ce-4c2e-b7f3-f810c468744f"],
Cell[51709, 1427, 514, 11, 94, "Input",ExpressionUUID->"41871feb-be88-4c4a-906f-c2dc74d5134c"],
Cell[52226, 1440, 576, 13, 34, "Input",ExpressionUUID->"25b0dd3d-cb36-47b1-a137-1ea75103b0f5"],
Cell[52805, 1455, 706, 16, 34, "Input",ExpressionUUID->"9743a92a-16f3-4a1a-9c24-413c39d3edad"],
Cell[53514, 1473, 730, 18, 34, "Input",ExpressionUUID->"e8458fa1-5052-4d6a-9930-fd3f15f9cfcf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54281, 1496, 258, 4, 64, "Subsection",ExpressionUUID->"511a4ed6-8fa1-4375-af86-a538d572d2e6"],
Cell[54542, 1502, 519, 11, 74, "Input",ExpressionUUID->"981a74d2-f813-4f56-8b2c-b697f583f90b"],
Cell[55064, 1515, 4524, 116, 525, "Input",ExpressionUUID->"fc240dd9-0ead-4fe9-8bfc-1e741174c64e"],
Cell[59591, 1633, 453, 11, 34, "Input",ExpressionUUID->"3605b44d-dc21-450a-adeb-f7aed4401bc3"],
Cell[60047, 1646, 264, 6, 34, "Input",ExpressionUUID->"70e4a377-5ff1-4c3a-8249-d535ed7b3cb5"],
Cell[60314, 1654, 458, 9, 34, "Input",ExpressionUUID->"7bf1a1c5-e3f8-45fa-9536-453b9b79d32f"],
Cell[60775, 1665, 156, 3, 34, "Input",ExpressionUUID->"c409425d-5950-4ca8-8e48-0d77e13d5a7e"],
Cell[60934, 1670, 577, 15, 57, "Input",ExpressionUUID->"09783538-5610-4175-955b-b6052527a84f"],
Cell[61514, 1687, 245, 5, 34, "Input",ExpressionUUID->"0f0b3eb4-8e20-48ee-8737-2a34da85a0f8"],
Cell[61762, 1694, 277, 6, 34, "Input",ExpressionUUID->"674b68ef-f136-4c2f-b5bc-fcc127ccd125"],
Cell[62042, 1702, 452, 12, 33, "Input",ExpressionUUID->"a0be5ca7-4fd9-46e7-b96b-8f3ff5a6808b"],
Cell[62497, 1716, 215, 5, 41, "Text",ExpressionUUID->"4ab2bdb2-9b55-49a8-9bd3-a77bcb77d1f4"],
Cell[62715, 1723, 474, 13, 57, "Input",ExpressionUUID->"a2b106bb-273a-4a4a-b200-9afa82ac1a11"],
Cell[63192, 1738, 359, 8, 33, "Input",ExpressionUUID->"c9ee9406-303f-4d36-aac1-cf5069b7b7e9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63588, 1751, 217, 4, 64, "Subsection",ExpressionUUID->"ccbbb18c-64fd-4ada-8962-c1bf0e820166"],
Cell[63808, 1757, 546, 13, 74, "Input",ExpressionUUID->"464b74ba-f630-4629-9846-4bde4a929f76"],
Cell[64357, 1772, 777, 18, 77, "Input",ExpressionUUID->"0bc35958-1882-4463-80af-17a7fa15c52b"],
Cell[65137, 1792, 13567, 326, 1793, "Input",ExpressionUUID->"8b46d6c8-7840-4e7f-977e-fe87b1f9fcee"],
Cell[78707, 2120, 3730, 109, 421, "Input",ExpressionUUID->"2cf87351-7d12-4ae1-978d-3ffb0c2350b0"],
Cell[82440, 2231, 2578, 63, 256, "Input",ExpressionUUID->"7645ea55-16ba-42fd-a4d2-fcf2ef278639"],
Cell[85021, 2296, 169, 3, 41, "Text",ExpressionUUID->"e995b5c7-1cb8-4346-878c-535395f3c334"],
Cell[85193, 2301, 786, 23, 80, "Input",ExpressionUUID->"eaafecff-ef40-44c8-84ea-751922b8f64a"],
Cell[85982, 2326, 161, 3, 41, "Text",ExpressionUUID->"fab1753c-3dc1-4a5d-ba70-0090261d4052"],
Cell[86146, 2331, 651, 19, 80, "Input",ExpressionUUID->"b043bad2-7b73-439e-a80e-2da6d806625c"],
Cell[86800, 2352, 175, 3, 41, "Text",ExpressionUUID->"269af99b-f433-4cba-81b1-1e63a607e0dd"],
Cell[86978, 2357, 527, 11, 57, "Input",ExpressionUUID->"eb80e257-bc30-4627-8b92-5e99fdbe017e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87542, 2373, 534, 16, 64, "Subsection",ExpressionUUID->"fff6dc1d-8a8a-460d-8e7f-7a640fe7119f"],
Cell[88079, 2391, 216, 3, 41, "Text",ExpressionUUID->"ff2b1566-907c-41a9-b914-3f45359b5b69"],
Cell[88298, 2396, 1480, 42, 123, "Input",ExpressionUUID->"4d2a46da-c17d-4ad2-916d-d9ec2231419c"],
Cell[89781, 2440, 193, 3, 41, "Text",ExpressionUUID->"f50c67b1-0e16-451c-afc0-64dc3f5375b7"],
Cell[89977, 2445, 1591, 41, 120, "Input",ExpressionUUID->"f72d28ba-1aea-4cdc-8e37-c3b1c2de7066"],
Cell[91571, 2488, 265, 6, 41, "Text",ExpressionUUID->"f71e970f-f045-4f0e-a3de-82a401d42b33"],
Cell[91839, 2496, 1115, 24, 94, "Input",ExpressionUUID->"5a7113c3-7390-4000-9072-ac50f3ce0056"],
Cell[92957, 2522, 476, 8, 41, "Text",ExpressionUUID->"30b9366d-cdba-4546-a68f-c5669f9b805f"],
Cell[93436, 2532, 4342, 109, 568, "Input",ExpressionUUID->"fc49d9ab-5716-4f53-acf2-572b763e3e5a"],
Cell[97781, 2643, 340, 8, 52, "Input",ExpressionUUID->"2b43487f-4d06-4592-9d6f-6e1d916b7fe2"],
Cell[98124, 2653, 316, 7, 41, "Text",ExpressionUUID->"ce58681e-2af2-4af7-9f6c-25a690df703e"],
Cell[98443, 2662, 4777, 134, 250, "Input",ExpressionUUID->"4c13fb7c-923e-4795-9faf-535ab1ea7298"],
Cell[103223, 2798, 575, 13, 43, "Text",ExpressionUUID->"0166fc55-ffff-4211-84eb-c669a47e0f02"],
Cell[CellGroupData[{
Cell[103823, 2815, 1931, 46, 100, "Input",ExpressionUUID->"65ae8749-1751-49de-80d1-dac29832b26f"],
Cell[105757, 2863, 864, 18, 26, "Print",ExpressionUUID->"96bfa9b9-2240-42ef-b46f-b2163c55dc6c"]
}, Open  ]],
Cell[106636, 2884, 249, 4, 41, "Text",ExpressionUUID->"9a342477-903f-4bf2-a143-8c42c679a8af"],
Cell[106888, 2890, 1589, 48, 123, "Input",ExpressionUUID->"d41f20d4-28fa-49aa-91ba-d83e2f0038fa"],
Cell[108480, 2940, 447, 12, 34, "Input",ExpressionUUID->"7540b839-a6a8-40af-9885-86c9bc145af8"],
Cell[108930, 2954, 213, 4, 41, "Text",ExpressionUUID->"5e37afad-df62-4693-9319-c2f38cd8ef11"],
Cell[109146, 2960, 948, 22, 57, "Input",ExpressionUUID->"7338c032-f6a4-471b-98e7-adaa3d5e9167"],
Cell[110097, 2984, 1063, 32, 67, "Text",ExpressionUUID->"a20b7ec5-636a-410f-b357-b766cbb4f8d9"],
Cell[111163, 3018, 1290, 34, 94, "Input",ExpressionUUID->"fbcaab1d-2134-4497-a331-2a85ce83c3df"],
Cell[112456, 3054, 450, 11, 41, "Text",ExpressionUUID->"14eb9508-1da7-413e-ba8c-9bc9fe0c4999"],
Cell[112909, 3067, 548, 16, 52, "Input",ExpressionUUID->"6c16d814-a78e-4016-88a3-3e2a60c675c1"],
Cell[113460, 3085, 175, 3, 41, "Text",ExpressionUUID->"1d5a3b62-4b90-496f-a584-503654007c5c"],
Cell[113638, 3090, 902, 24, 77, "Input",ExpressionUUID->"5ff9b9d5-2e01-42dd-94a7-6cd7b0489579"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

